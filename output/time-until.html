<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="In a previous post I described how I was introduced to CoffeeScript via Übersicht (a desktop widget app for OS X) and eventually published the &#34;Time Since&#34; widget to the widgets gallery. Seeing a...">
        <meta name="keywords" content="AppleScript, CoffeeScript, JavaScript, Time Until, Übersicht">
        <link rel="icon" href="/favicon.ico">

        <title>Time Until - John Mathews</title>

        <!-- Stylesheets -->
        <link href="/theme/css/bootstrap.min.css" rel="stylesheet">
        <link href="/theme/css/fonts.css" rel="stylesheet">
        <link href="/theme/css/nest.css" rel="stylesheet">
        <link href="/theme/css/pygment.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->



    </head>

    <body>

        <!-- Header -->
    <div class="header-container gradient">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="/"><img class="mr20" src="/images/logo.jpeg" alt="logo">John Mathews</a>
                    </div>
                    <div class="nav pull-right">
                            <a  href="/pages/about.html">About</a>
                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <!-- Header -->
    <!--
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">   
                  <div class="header-content">
                     <h1 class="header-title">Time Until</h1>
                      <p class="header-date">By <a href="/author/jm.html">JM</a>, Aug 07 2016, in category <a href="/category/web.html">Web</a></p>
                      <div class="header-underline"></div>
                      <div class="clearfix"></div>
                      <p class="pull-right header-tags">
                          <span class="glyphicon glyphicon-tags mr5" aria-hidden="true"></span>
<a href="/tag/applescript.html">AppleScript</a>, <a href="/tag/coffeescript.html">CoffeeScript</a>, <a href="/tag/javascript.html">JavaScript</a>, <a href="/tag/time-until.html">Time Until</a>, <a href="/tag/ubersicht.html">Übersicht</a>                      </p>
                  </div> 
              </div>
        </div>
    </div>
    -->
    <!-- /Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <p>In a previous <a href="http://www.johnmathews.eu/2016/07/30/time-since/">post</a> I
described how I was introduced to CoffeeScript via
<a href="http://tracesof.net/uebersicht/">Übersicht</a> (a desktop widget app for
OS X) and eventually published the "<a href="http://tracesof.net/uebersicht-widgets/#time_since">Time
Since</a>" widget to
the widgets gallery.</p>
<p>Seeing a few people download the widget was really satisfying, and I was
soon wondering what else I could publish. As a pragmatic engineer, it
seemed clear to me what the next widget should do: If my first widget
calculated the time since an event, the next should calculate the time
until an event. I set out to create the companion to "Time Since" and
improve upon the underlying code.</p>
<p>My first code design choice was to cut out the use of an Apple Script
and calculated everything in one CoffeeScript. It would be more
efficient and easier to read.</p>
<p>Unfortunately I soon began to realise why the original widget I'd  built
"Time Since" around, had used AppleScript to calculate the time elapsed.
Date-Times are fiddly to work with in many languages, and this is true
in JavaScript also.</p>
<p>My code began to look increasingly like spaghetti as I tried to achieve
6 key features:</p>
<ol>
<li>Calculate the number of months and days between two dates
    (complicated by the varying number of days in different months)</li>
<li>Add the option to specify the level of detail in the output text (to
    the minute, to the hour, to the day, etc.)</li>
<li>Remove any 0 amounts from the output ("2 Months and 5 Hours" not "2
    Months, 0 Days and 5 Hours")</li>
<li>Add the option to abbreviate times ('years' → 'y', 'hours' → 'h',
    'and' → '&amp;', etc.)</li>
<li>Output a grammatically correct sentence (correct pluralisation and
    comma separated terms, with an "and" between the last two terms)</li>
<li>Prepend and append users defined strings</li>
</ol>
<p>After a few frustrating hours, it was clear that it would be a lot
easier to modify the existing AppleScript rather than reinvent the wheel
in JavaScript. I decided to use it instead of using only JavaScript as I
knew the AppleScript file could correctly consider the number of days in
the months between the 2 dates (feature 1), and it contains a function
to pluralise the correct parts of the string (feature 5).</p>
<p>The remaining features were added by using a combination of
<em>if </em>statements and arrays. The <em>if</em> statements simply ask if an amount
is equal to zero. If not, then it's appended to an array of terms to
include in the output. At the end of this code chunk it's possible to
ask how many non-zero terms to include in the output. An array with
length one less than the number of output terms is created and filled
with commas with an 'and' in the final position.</p>
<p>The two arrays are combined in the correct order by looping through the
index of the longer array and appending each term to a final array. The
final array is the output.</p>
<p><em>'<a href="http://tracesof.net/uebersicht-widgets/#time_until">Time Until</a>'</em> can
be downloaded from the <a href="http://tracesof.net/uebersicht/">Übersicht</a>
widgets <a href="http://tracesof.net/uebersicht-widgets/">gallery</a>. I think
another useful feature would be an option to specify the output only in
terms of a chosen amount, such as weeks or days, maybe I'll do that in
the future.</p>

    
    <div class="neighbors">
         <ul>
                 <li class="previous_article">
                     <a href="/how-to-wake-up-early.html">
                         How to wake up early
                     </a>
                 </li>
             
                 <li class="next_article">
                     <a href="/p90x.html">
                         P90x
                     </a>
                 </li>
        </ul>
    </div>
        
    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <!--
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Sitemap</div>
                        <ul class="list-unstyled">
                            <li><a href="/archives.html">Archives</a></li>
                            <li><a href="/tags.html">Tags</a></li>
                            <li><a href="/authors.html">Authors</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Social</div>
                        <ul class="list-unstyled">
                            <li><a href="#" target="_blank">You can add links in your config file</a></li>
                            <li><a href="#" target="_blank">Another social link</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Links</div>
                        <ul class="list-unstyled">
                            <li><a href="http://getpelican.com/" target="_blank">Pelican</a></li>
                            <li><a href="http://python.org/" target="_blank">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/" target="_blank">Jinja2</a></li>
                            <li><a href="#" target="_blank">You can modify those links in your config file</a></li>
                        </ul>
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme and code by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small>&copy; blogname 2015</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        -->
        <!-- /Footer -->
    </body>
</html>