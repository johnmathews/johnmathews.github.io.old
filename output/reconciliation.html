<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Reconciliation of a Trial Balance to a General Ledger¶ I’ve been working with financial ledgers a lot recently. The python code below shows an automated workflow to import, process and report on...">
        <meta name="keywords" content="">
        <link rel="icon" href="./favicon.ico">

        <title>Reconciliation of a trial balance to a general&nbsp;ledger - John Mathews</title>

        <!-- Stylesheets -->
        <link href="./theme/css/bootstrap.min.css" rel="stylesheet">
        <link href="./theme/css/fonts.css" rel="stylesheet">
        <link href="./theme/css/nest.css" rel="stylesheet">
        <link href="./theme/css/pygment.css" rel="stylesheet">
        <link href="./theme/css/lightbox.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

        <!-- Google Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-82253540-1', 'auto');
          ga('send', 'pageview');
        </script>
        <!-- /Google Analytics -->


    </head>

    <body>

        <!-- Header -->
    <div class="header-container gradient">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo ">
                        <a class="pull-left hidden-xs" href="./"><img class="mr20" src="./images/logo.jpeg" alt="logo"> </a>
                        <a class="pull-left" href="./">John Mathews </a>
                    </div>
                    <div class="nav pull-right">
                            <a  href="./pages/about.html">About</a>
                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    
    <div class="container content">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Reconciliation-of-a-Trial-Balance-to-a-General-Ledger">Reconciliation of a Trial Balance to a General Ledger<a class="anchor-link" href="#Reconciliation-of-a-Trial-Balance-to-a-General-Ledger">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I&#8217;ve been working with financial ledgers a lot recently. The python code below shows an automated workflow to import, process and report on the reconciliation of a Trial Balance (<span class="caps">TB</span>) to a General Ledger (<span class="caps">GL</span>).</p>
<p>I&#8217;m using fake data, but the script would work fine with real data if the fields were renamed appropriately. A real data set would have additional fields that needed to be condidered but these vary depending on the size and type of business being analysed. Therefore the fake <span class="caps">GL</span> and <span class="caps">TB</span> used here are simple and generic. Additional fields, such as entity code, transaction status, approver, time stamps, etc can be added quickly and&nbsp;simply.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Set-up the notebook, Import&nbsp;data:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import libraries</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">random</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import (possibly incomplete and/or inaccurate) data</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'glx.txt'</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">'|'</span><span class="p">)</span>
<span class="n">tb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'tbx.txt'</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">'|'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create reconciliation&nbsp;report:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Calculate net movement for each account in the ledger&nbsp;data:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gl_move</span> <span class="o">=</span> <span class="n">gl</span><span class="p">[[</span><span class="s1">'Account'</span><span class="p">,</span><span class="s1">'Functional_Amount'</span><span class="p">]]</span>
<span class="n">gl_move</span> <span class="o">=</span> <span class="n">gl_move</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'Account'</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">gl_move</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gl_move</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Account'</span><span class="p">,</span><span class="s1">'GL_Movement'</span><span class="p">]</span>
<span class="n">gl_move</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">'Account'</span><span class="p">)</span>
<span class="n">gl_move</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">'Account'</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Calculate the movement for each account in the trial balance&nbsp;data:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tb</span><span class="p">[</span><span class="s1">'TB_Movement'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="n">tb</span><span class="p">[</span><span class="s1">'Balance c/f'</span><span class="p">]</span> <span class="o">-</span> <span class="n">tb</span><span class="p">[</span><span class="s1">'Balance b/f'</span><span class="p">]</span> <span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">tb</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">'Account'</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Compare each accounts movement in the ledger data and the trial balance and write the result to a report containing the reconciliation results for all&nbsp;accounts:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Rec_report</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">gl_move</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">'outer'</span><span class="p">,</span> <span class="n">left_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">Rec_report</span><span class="p">[</span><span class="s1">'difference'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rec_report</span><span class="o">.</span><span class="n">TB_Movement</span> <span class="o">-</span> <span class="n">Rec_report</span><span class="o">.</span><span class="n">GL_Movement</span>
<span class="n">Rec_report</span><span class="p">[</span><span class="s1">'difference'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rec_report</span><span class="p">[</span><span class="s1">'difference'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">Rec_report</span><span class="p">[</span><span class="s1">'Balance date'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rec_report</span><span class="p">[</span><span class="s1">'Balance date'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
<span class="n">Rec_report</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">'All_accounts.txt'</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">'|'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'utf-8'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Put the accounts which do not reconcile into a seperate&nbsp;report:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Unreconciled</span> <span class="o">=</span> <span class="n">Rec_report</span><span class="p">[</span><span class="n">Rec_report</span><span class="o">.</span><span class="n">difference</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">Unreconciled</span> <span class="o">=</span> <span class="n">Unreconciled</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">Unreconciled</span><span class="o">.</span><span class="n">difference</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">Unreconciled</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">'Unreconciled_accounts.txt'</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">'|'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'utf-8'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Unreconciled</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[6]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Type</th>
<th>Balance b/f</th>
<th>Balance c/f</th>
<th>Balance date</th>
<th>TB_Movement</th>
<th>GL_Movement</th>
<th>difference</th>
</tr>
<tr>
<th>Account</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th><span class="caps">ACP00081</span></th>
<td>P&L;</td>
<td>0.00</td>
<td>-16279.96</td>
<td>20161231</td>
<td>-16279.96</td>
<td>-17017.89</td>
<td>737.93</td>
</tr>
<tr>
<th><span class="caps">ACB00082</span></th>
<td><span class="caps">BS</span></td>
<td>760.09</td>
<td>-4041.02</td>
<td>20161231</td>
<td>-4801.11</td>
<td>-4063.18</td>
<td>-737.93</td>
</tr>
<tr>
<th><span class="caps">ACP00071</span></th>
<td>P&L;</td>
<td>0.00</td>
<td>-28547.84</td>
<td>20161231</td>
<td>-28547.84</td>
<td>-29260.31</td>
<td>712.47</td>
</tr>
<tr>
<th><span class="caps">ACB00091</span></th>
<td><span class="caps">BS</span></td>
<td>628.24</td>
<td>3054.74</td>
<td>20161231</td>
<td>2426.50</td>
<td>3138.97</td>
<td>-712.47</td>
</tr>
<tr>
<th><span class="caps">ACP00017</span></th>
<td>P&L;</td>
<td>654.01</td>
<td>24449.74</td>
<td>20161231</td>
<td>23795.73</td>
<td>23123.06</td>
<td>672.67</td>
</tr>
<tr>
<th><span class="caps">ACB00076</span></th>
<td><span class="caps">BS</span></td>
<td>768.49</td>
<td>-48456.11</td>
<td>20161231</td>
<td>-49224.60</td>
<td>-48551.93</td>
<td>-672.67</td>
</tr>
<tr>
<th><span class="caps">ACB00037</span></th>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>nan</td>
<td>NaN</td>
<td>19808.54</td>
<td>NaN</td>
</tr>
<tr>
<th><span class="caps">ACP00001</span></th>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>nan</td>
<td>NaN</td>
<td>-3817.92</td>
<td>NaN</td>
</tr>
<tr>
<th><span class="caps">ACP00041</span></th>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>nan</td>
<td>NaN</td>
<td>-14365.77</td>
<td>NaN</td>
</tr>
<tr>
<th><span class="caps">ACP00046</span></th>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>nan</td>
<td>NaN</td>
<td>1825.79</td>
<td>NaN</td>
</tr>
<tr>
<th><span class="caps">ACP00086</span></th>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>nan</td>
<td>NaN</td>
<td>-7263.37</td>
<td>NaN</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create a report containing summary&nbsp;details:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Accounts not in the TB but in the GL</span>
<span class="n">Accounts_not_in_TB</span> <span class="o">=</span> <span class="n">Unreconciled</span><span class="p">[</span><span class="n">Unreconciled</span><span class="o">.</span><span class="n">TB_Movement</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Accounts in the TB where TB_Movement isn't matched in the GL</span>
<span class="n">Missing_journals</span> <span class="o">=</span> <span class="n">Unreconciled</span><span class="p">[(</span><span class="n">Unreconciled</span><span class="o">.</span><span class="n">GL_Movement</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span><span class="o">|</span><span class="p">(</span><span class="n">Unreconciled</span><span class="o">.</span><span class="n">difference</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span><span class="kc">False</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Total_Accounts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Rec_report</span><span class="p">)</span>
<span class="n">Num_Rec_Accounts</span> <span class="o">=</span> <span class="n">Total_Accounts</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">Unreconciled</span><span class="p">)</span>
<span class="n">Num_Unrec_Accounts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Unreconciled</span><span class="p">)</span>
<span class="n">Rec_Fraction</span> <span class="o">=</span> <span class="n">Num_Rec_Accounts</span> <span class="o">/</span> <span class="n">Total_Accounts</span>
<span class="n">Unrec_Fraction</span> <span class="o">=</span> <span class="n">Num_Unrec_Accounts</span> <span class="o">/</span> <span class="n">Total_Accounts</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"Report.txt"</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">text_file</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'The data contains'</span><span class="p">,</span><span class="n">Total_Accounts</span><span class="p">,</span> <span class="s1">'accounts'</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">text_file</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Num_Rec_Accounts</span><span class="p">,</span> <span class="s1">'accounts reconcile ('</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">Rec_Fraction</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">'%)</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">text_file</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Num_Unrec_Accounts</span><span class="p">,</span> <span class="s1">'accounts do not reconcile ('</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">Unrec_Fraction</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">'%)'</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">text_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"Report.txt"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">)</span> <span class="k">as</span> <span class="n">text_file</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'There are'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Accounts_not_in_TB</span><span class="p">),</span> <span class="s1">'accounts in the GL and not in the TB. ('</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Accounts_not_in_TB</span><span class="p">)</span><span class="o">/</span><span class="n">Num_Unrec_Accounts</span><span class="p">),</span><span class="mi">2</span><span class="p">),</span> <span class="s1">'</span><span class="si">% o</span><span class="s1">f unreconciled accounts)'</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">text_file</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'There are'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Missing_journals</span><span class="p">),</span> <span class="s1">'accounts with journals missing ('</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Missing_journals</span><span class="p">)</span><span class="o">/</span><span class="n">Num_Unrec_Accounts</span><span class="p">),</span><span class="mi">2</span><span class="p">),</span> <span class="s1">'</span><span class="si">% o</span><span class="s1">f unreconciled accounts)'</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">text_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net_diff</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">Unreconciled</span><span class="p">[</span><span class="n">Unreconciled</span><span class="o">.</span><span class="n">difference</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">]</span><span class="o">.</span><span class="n">difference</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span><span class="mi">2</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"Report.txt"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">)</span> <span class="k">as</span> <span class="n">text_file</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'The net of all the differences is'</span><span class="p">,</span> <span class="n">net_diff</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">text_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Does the TB balance?</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"Report.txt"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">)</span> <span class="k">as</span> <span class="n">text_file</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">TB opening balance is unbalanced by'</span><span class="p">,</span> <span class="s2">"</span><span class="si">%.2f</span><span class="s2">"</span> <span class="o">%</span> <span class="n">tb</span><span class="p">[</span><span class="s1">'Balance b/f'</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">file</span><span class="o">=</span><span class="n">text_file</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'TB closing balance is unbalanced by'</span><span class="p">,</span><span class="s2">"</span><span class="si">%.2f</span><span class="s2">"</span> <span class="o">%</span> <span class="n">tb</span><span class="p">[</span><span class="s1">'Balance c/f'</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">file</span><span class="o">=</span><span class="n">text_file</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'***If these are not 0 then the TB is certainly wrong and receiving a </span><span class="se">\n</span><span class="s1">balanced TB is the first step to reconciling all accounts***'</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">text_file</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">diffs</span> <span class="o">=</span> <span class="n">Unreconciled</span><span class="o">.</span><span class="n">difference</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">frequency</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">diffs</span><span class="p">:</span>
    <span class="n">frequency</span><span class="p">[</span><span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="n">frequency</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

<span class="n">pairs</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">frequency</span> <span class="k">if</span> <span class="n">x</span> <span class="o">></span> <span class="mi">1</span><span class="p">}</span> <span class="c1"># dict comprehension to filter for pairs </span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"Report.txt"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">)</span> <span class="k">as</span> <span class="n">text_file</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">There are'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">pairs</span><span class="p">),</span> <span class="s1">'unreconciled accounts with equal and opposite differences'</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">text_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'Report.txt'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fin</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fin</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>The data contains 110 accounts
99 accounts reconcile ( 90.0 %)

11 accounts do not reconcile ( 10.0 %)
There are 5 accounts in the GL and not in the TB. ( 45.45 % of unreconciled accounts)
There are 6 accounts with journals missing ( 54.55 % of unreconciled accounts)
The net of all the differences is 0.0

TB opening balance is unbalanced by -2486.28
TB closing balance is unbalanced by 1326.45
***If these are not 0 then the TB is certainly wrong and receiving a 
balanced TB is the first step to reconciling all accounts***

There are 3 unreconciled accounts with equal and opposite differences

</pre>
</div>
</div>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>


    
        <div class="neighbors">
             <ul>
                     <li class="previous_article">
                         <a href="./spotify.html">
                             Spotify song&nbsp;history
                         </a>
                     </li>
                 
                     <li class="next_article">
                         <a href="./fakegl-a-synthetic-general-ledger-and-trial-balance.html">
                             FakeGL a Synthetic General Ledger and Trial&nbsp;Balance
                         </a>
                     </li>
            </ul>
        </div>
    
        <div> 

    <div class="comments">
        <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'johnmathews';
                var disqus_identifier = 'reconciliation.html';
                var disqus_url = './reconciliation.html';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
        <noscript>Please enable JavaScript to view the comments.</noscript>
    </div>

<!--
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://johnmathews.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
-->                           </div>
    </div>    
        <!-- /Content --> 
        
        <script src="./theme/js/lightbox-plus-jquery.js"></script>
        <script>
            lightbox.option({
              'resizeDuration': 400,
              'wrapAround': true,
              'imageFadeDuration': 300,
              'disableScrolling': true,
              'showImageNumberLabel': true,
              'positionFromTop': 50
            })
        </script>
    </body>
</html>