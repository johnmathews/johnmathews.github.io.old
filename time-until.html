<!doctype html>
<html lang="en">
  <head>
        <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

      <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
      <!--[if lt IE 9]>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
      <![endif]-->

      <title> Übersicht widget: Time Until -  JohnMathews.eu  </title>
      <meta name="title" content=" Übersicht widget: Time Until -  JohnMathews.eu  " />
      <meta property="og:title" content="Übersicht widget: Time Until" />
      <meta property="twitter:title" content="Übersicht widget: Time Until " />

      <meta name="keywords" content=" AppleScript,CoffeeScript,JavaScript,Time Until,Übersicht,Widgets " />
      <meta name="author" content="John Mathews" />
      <meta name="twitter:creator" content="@johnmathews" />

      <meta name="description" content="In a previous post I described how I was introduced to CoffeeScript via Übersicht, the desktop widget app for OS X, and eventually published the “Time Since” widget. Seeing a few people download..." />
      <meta name="twitter:description" content="In a previous post I described how I was introduced to CoffeeScript via Übersicht, the desktop widget app for OS X, and eventually published the “Time Since” widget. Seeing a few people download..." />
      <meta property="og:description" content="In a previous post I described how I was introduced to CoffeeScript via Übersicht, the desktop widget app for OS X, and eventually published the “Time Since” widget. Seeing a few people download..." />

      <meta property="og:url" content="https://johnmathews.eu/time-until.html" />
      <meta property="twitter:url" content="https://johnmathews.eu/time-until.html" />

      <meta name="twitter:image" content="https://johnmathews.eu/ " />
      <meta property="og:image" content="https://johnmathews.eu/ " />

      <meta property="twitter:card" content="summary" />
      <meta name="twitter:domain" content="https://johnmathews.eu" />

      <meta property="og:type" content="article" />

      <link rel="icon" href="https://johnmathews.eu/favicon.png" />

        <script>
          window.ga = window.ga || function () {
                      (ga.q = ga.q || []).push(arguments);
                    };
                    ga.l = +new Date();
                    ga("create", "UA-82253540-1", "auto");
                    ga("send", "pageview");
        </script>
        <script async src="https://www.google-analytics.com/analytics.js"></script>

      <script async src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>

      <link href="https://johnmathews.eu/theme/css/styles.css" rel="stylesheet" />
      <link href="https://johnmathews.eu/theme/css/pygment.css" rel="stylesheet" />


  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin="anonymous" />

  <link href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css" rel="stylesheet" type="text/css">
  <style type="text/css">
      #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
      /* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
         We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
  </style>
  </head>

  <body class="dark:bg-gray-800">
    <a class="pt-20 mt-20 " name="top"></a>
    <nav class="text-xl top-0 w-full lg:fixed flex flex-wrap items-center justify-between p-5 bg-gradient-to-r dark:from-blue-900 dark:to-blue-800 from-yellow-400 to-pink-400">
      <div>
        <a class="dark:text-gray-300 prose prose-xl text-gray-700 hover:text-white font-semibold block md:inline-block px-3 py-3" href="https://johnmathews.eu/foo">JohnMathews.eu</a>
      </div>
      <div class="flex md:hidden">
        <button id="hamburger">
          <img class="dark:text-gray-300 toggle rounded-xl dark:bg-blue-600 block" src="https://img.icons8.com/fluent-systems-regular/2x/menu-squared-2.png" width="40" height="40" />
          <img class="dark:text-gray-300 toggle rounded-xl dark:bg-blue-600 hidden" src="https://img.icons8.com/fluent-systems-regular/2x/close-window.png" width="40" height="40" />
        </button>
      </div>
      <div class="dark:text-gray-300 toggle hidden md:flex w-full md:w-auto text-right text-bold mt-5 md:mt-0 border-t-2 border-blue-900 md:border-none">
        <a class="dark:text-gray-300 prose prose-xl text-gray-700 hover:text-white font-semibold block md:inline-block px-3 py-3 border-b-2 border-blue-900 md:border-none" href="https://johnmathews.eu/about">About</a>
        <a class="dark:text-gray-300 prose prose-xl text-gray-700 hover:text-white font-semibold block md:inline-block px-3 py-3 border-b-2 border-blue-900 md:border-none" href="https://johnmathews.eu/experience">Experience</a>
      </div>
    </nav>

    <main class="lg:mt-20 lg:pt-5 dark:bg-gray-800">
  <div class="-ml-5 -mr-5 lg:mx-auto max-w-4xl px-10 my-4 py-6 rounded-lg shadow-md dark:bg-gray-700">

      <div class="markdown text-center dark:text-gray-200">
        <h1> Übersicht widget: Time&nbsp;Until </h1>
      </div>

      <div class="py-1 text-gray-700 font-bold text-center dark:text-gray-200">
        By John Mathews
      </div>

      <div class="py-1 text-gray-700 font-bold text-center dark:text-gray-200">
        Category:
          <a href="https://johnmathews.eu/category/technical/web.html">Web</a>
          
      </div>

      <div class="font-light text-gray-600 pb-5 text-center dark:text-gray-200">
        August 2016
      </div>


      <div class="markdown dark:text-gray-200">
        <p>In a <a href="https://johnmathews.eu/ubersicht-widget-time-since.html">previous post</a> I described how I was introduced to CoffeeScript via <a href="http://tracesof.net/uebersicht/">Übersicht</a>, the desktop widget app for <span class="caps">OS</span> X, and eventually published the &#8220;<a href="http://tracesof.net/uebersicht-widgets/#time_since">Time Since</a>&#8221;&nbsp;widget.</p>
<p>Seeing a few people download the widget was really satisfying, and I was soon wondering what else I could publish. As a pragmatic engineer, it seemed clear to me what the next widget should do: If my first widget calculated the time since an event, the next should calculate the time until an event. I set out to create the companion to &#8220;Time Since&#8221; and
improve upon the underlying&nbsp;code.</p>
<p>My first code design choice was to cut out the use of an Apple Script and calculated everything in one CoffeeScript file. It would be more efficient and easier to&nbsp;read.</p>
<p>Unfortunately I soon began to realise why the original widget I&#8217;d based &#8220;Time Since&#8221; on had used AppleScript to calculate the time elapsed. Date-Times are fiddly to work with in many languages, and this is true in JavaScript&nbsp;also.</p>
<p>My code began to look increasingly like spaghetti as I tried to achieve 6 key&nbsp;features:</p>
<ol>
<li>Calculate the number of months and days between two dates
    (complicated by the varying number of days in different&nbsp;months)</li>
<li>Add the option to specify the level of detail in the output text (to
    the minute, to the hour, to the day,&nbsp;etc.)</li>
<li>Remove any 0 amounts from the output (&#8220;2 Months and 5 Hours&#8221; not &#8220;2
    Months, 0 Days and 5&nbsp;Hours&#8221;)</li>
<li>Add the option to abbreviate times (&#8216;years&#8217; → &#8216;y&#8217;, &#8216;hours&#8217; → &#8216;h&#8217;,
    &#8216;and&#8217; → &#8216;&amp;&#8217;,&nbsp;etc.)</li>
<li>Output a grammatically correct sentence (correct pluralisation and
    comma separated terms, with an &#8220;and&#8221; between the last two&nbsp;terms)</li>
<li>Prepend and append users defined&nbsp;strings</li>
</ol>
<p>After a few frustrating hours, it was clear that it would be a lot easier to modify the existing AppleScript rather than reinvent the wheel in JavaScript. I decided to use it instead of using only JavaScript as I knew the AppleScript file could correctly consider the number of days in
the months between the 2 dates (feature 1), and it contains a function to pluralise the correct parts of the string (feature&nbsp;5).</p>
<p>The remaining features were added by using a combination of if statements and arrays. The if statements simply ask if an amount is equal to zero. If not, then it&#8217;s appended to an array of terms to include in the output. At the end of this code chunk it&#8217;s possible to ask how many non-zero terms to include in the output. An array with length one less than the number of output terms is created and filled with commas with an &#8216;and&#8217; in the final&nbsp;position.</p>
<p>The two arrays are combined in the correct order by looping through the index of the longer array and appending each term to a final array. The final array is the&nbsp;output.</p>
<p><em><span class="quo">&#8216;</span><a href="http://tracesof.net/uebersicht-widgets/#time_until">Time Until</a>&#8217;</em> can be downloaded from the <a href="http://tracesof.net/uebersicht/">Übersicht</a> <a href="http://tracesof.net/uebersicht-widgets/">widgets gallery</a>. I think another useful feature would be an option to specify the output only in terms of a chosen amount, such as weeks or days. Maybe I&#8217;ll do that in the&nbsp;future.</p>
      </div>

      <div class="border border-gray-300 mt-10 mb-10"></div>

        <div class="mb-10 text-lg dark:text-gray-200">
            <div class="flex flex-row">
              <div class="text-red-500 dark:text-red-500"> &#x2190;  </div>
              <a class=" dark:text-gray-200 px-1 hover:text-green-700 dark:hover:text-red-500" href="https://johnmathews.eu/ubersicht-widget-time-since.html"> Übersicht widget: Time&nbsp;Since</a>
            </div>
            <div class="flex flex-row">
              <div class="text-green-500 dark:text-green-200"> &#x2192; </div>
              <a class="dark:text-gray-200 text-left px-1 hover:text-green-700 dark:hover:text-green-200" href="https://johnmathews.eu/pelican.html"> Blogging with&nbsp;Pelican</a>
            </div>
        </div>

      <div class="text-left">
        <button id="signupButton" class="inline-flex items-center h-10 px-5 text-indigo-100 transition-colors duration-150 bg-indigo-700 rounded-lg focus:shadow-outline hover:bg-indigo-800">
          <span>Subscribe</span>
          <i class="py-2 pl-3 fas fa-lg fa-envelope"></i>
        </button>
      </div>

      <div class="hidden" id="subscribeBox" >
        <!-- Begin Mailchimp Signup Form -->
        <div id="mc_embed_signup">
          <form action="https://johnmathews.us15.list-manage.com/subscribe/post?u=293155ea06a261f5255378dc0&amp;id=38c1e277b4" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate dark:bg-gray-700" target="_blank" novalidate>
            <div id="mc_embed_signup_scroll">
              <div class="mc-field-group dark:text-gray-300">
                <label for="mce-EMAIL">Email Address </label>
                <input type="email" value="" name="EMAIL" class="required email dark:bg-gray-500" id="mce-EMAIL">
              </div>
              <div id="mce-responses" class="clear">
                <div class="response" id="mce-error-response" style="display:none"></div>
                <div class="response" id="mce-success-response" style="display:none"></div>
              </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
              <div style="position: absolute; left: -5000px;" aria-hidden="true">
                <input type="text" name="b_293155ea06a261f5255378dc0_38c1e277b4" tabindex="-1" value="">
              </div>
              <div class="clear">
                <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
              </div>
            </div>
          </form>
        </div>
        <script type='text/javascript' src='//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js'></script><script type='text/javascript'>(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';}(jQuery));var $mcj = jQuery.noConflict(true);</script>
        <!--End mc_embed_signup-->
      </div>

         <div class="mt-10" id="disqus_thread"></div>
          <script>
            /**
            *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
            *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
            var disqus_config = function () {
            this.page.url = "https://johnmathews.eu/time-until.html";  // Replace PAGE_URL with your page's canonical URL variable
            this.page.identifier = "time-until.html"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
            };
            (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = 'https://johnmathews.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
            })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

      </div>
    </main>

    <div class="footer">
      <div class="text-center py-3 dark:bg-gray-800 dark:text-gray-100">
        <a href="https://johnmathews.eu/foo">Blog Posts</a> |
        <a href="#top">Back to top</a> |
        <a href="https://johnmathews.eu/categories">Categories</a> |
        <a href="feeds/all.atom.xml">RSS</a>
      </div>
    </div>

    <div>
          <script>
          document.getElementById("hamburger").onclick = function toggleMenu() {
            const navToggle = document.getElementsByClassName("toggle");
            for (let i = 0; i < navToggle.length; i++) {
              navToggle.item(i).classList.toggle("hidden");
            }
          };
        </script>

  <script>
    document.getElementById("signupButton").addEventListener("click", function(e) {
          $('#signupButton').removeClass('block').addClass('hidden')
          $('#subscribeBox').removeClass('hidden').addClass('block')
        });
  </script>
    </div>
  </body>

</html>