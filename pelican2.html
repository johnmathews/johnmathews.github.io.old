<!DOCTYPE html>

<html class="" id="baz" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
      <![endif]-->
<title>Blogging with Pelican: Design, Plugins, Sharing - John Mathews Blog - JohnMathews.eu</title>
<meta content="Blogging with Pelican: Design, Plugins, Sharing -  John Mathews Blog - JohnMathews.eu " name="title"/>
<meta content="John Mathews" name="author"/>
<meta content=" Blog,Facebook,Jinja,Pelican,Python,Static Site,Twitter " name="keywords"/>
<meta content=" My site is optimised for speed and clarity. I’ve added share buttons using a plugin which I modified and improved, and added meta tags to control how Twitter and Facebook show my articles in feeds. " name="description"/>
<meta content="@johnmathews" name="twitter:creator"/>
<meta content="https://johnmathews.eu" name="twitter:domain"/>
<meta content="Blogging with Pelican: Design, Plugins, Sharing" property="twitter:title"/>
<meta content=" My site is optimised for speed and clarity. I’ve added share buttons using a plugin which I modified and improved, and added meta tags to control how Twitter and Facebook show my articles in feeds. " name="twitter:description"/>
<meta content="https://johnmathews.eu/pelican2.html" property="twitter:url"/>
<meta content="    https://johnmathews.eu//images/get_pelican.png" name="twitter:image"/>
<meta content="  summary_large_image  " property="twitter:card"/>
<meta content=" article " property="og:type"/>
<meta content="Blogging with Pelican: Design, Plugins, Sharing" property="og:title"/>
<meta content=" My site is optimised for speed and clarity. I’ve added share buttons using a plugin which I modified and improved, and added meta tags to control how Twitter and Facebook show my articles in feeds. " property="og:description"/>
<meta content="https://johnmathews.eu/pelican2.html" property="og:url"/>
<meta content="    https://johnmathews.eu//images/get_pelican.png" property="og:image"/>
<link href="https://johnmathews.eu/feeds/all.atom.xml" rel="alternate" title="John Mathews Feed" type="application/atom+xml"/>
<script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link async="" href="https://fonts.googleapis.com/css2?family=Cardo&amp;display=swap" rel="stylesheet"/>
<link async="" href="https://fonts.googleapis.com/css2?family=Anonymous+Pro&amp;display=swap" rel="stylesheet"/>
<script>
          window.ga = window.ga || function () {
            (ga.q = ga.q || []).push(arguments);
          };
          ga.l = +new Date();
          ga("create", "UA-82253540-1", "auto");
          ga("send", "pageview");
        </script>
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<link href="https://johnmathews.eu/extra/favicon.png" rel="icon">
<link href="https://johnmathews.eu/theme/css/styles.css" rel="stylesheet">
<link href="https://johnmathews.eu/theme/css/pygment-light.css" id="PygmentCSS" media="print" onload="this.media='all'" rel="stylesheet">
<script>
        if (localStorage.getItem('theme') === 'dark') {
          document.getElementById('baz').classList.add('dark')
        }
      </script>
</link></link></link></head>
<body class="dark:bg-black">
<a class="pt-20 mt-20" name="top"></a>
<nav class="d:fixed top-0 w-full flex flex-row justify-between pt-2 text-xl bg-white dark:bg-black" id="navbar" style="transition: top 0.3s ease-in-out;">
<div class="text-bold pr-3 hidden md:flex md:flex-grow xl:hidden">
<div class="mt-10 md:mt-0 flex-grow justify-between">
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1" href="https://johnmathews.eu/blog.html">Blog</a>
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1" href="javaScript:;" id="searchButton2">Search</a>
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1" href="https://johnmathews.eu/portfolio.html">Portfolio</a>
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1" href="https://johnmathews.eu/about.html">About</a>
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1" href="https://johnmathews.eu/experience.html">Experience</a>
</div>
<div class="flex-none justify-end px-2 pt-2">
<button aria-label="themeToggle" class="inline-block theme-toggle" id="modeSwitcher1">
<div class="day modeIcon hidden">
<i class="mb-2 pb-2 far fa-lightbulb fa-lg"></i>
</div>
<div class="night modeIcon">
<i class="mb-2 pb-2 far fa-moon fa-lg"></i>
</div>
</button>
<button aria-label="Category chooser" class="catChooser hidden md:mt-0 ml-5 md:pl-0" id="">
<i class="mb-2 pb-2 fas fa-paw fa-lg"></i>
</button>
</div>
</div>
<div class="flex-none md:hidden block md:inline-block">
<button aria-label="Menu" class="mx-2 my-1" id="hamburger">
<div class="toggle"><i class="fas fa-bars fa-lg"></i></div>
<div class="hidden toggle"><i class="fas fa-times fa-lg"></i></div>
</button>
</div>
</nav>
<div class="toggle hidden w-screen flex flex-col text-left mt-5">
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1 text-2xl" href="https://johnmathews.eu/blog.html">Blog</a>
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1 text-2xl" href="javaScript:;" id="searchButton3">Search</a>
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1 text-2xl" href="https://johnmathews.eu/portfolio.html">Portfolio</a>
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1 text-2xl" href="https://johnmathews.eu/about.html">About</a>
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1 text-2xl" href="https://johnmathews.eu/experience.html">Experience</a>
<div class="px-3 pt-3 flex flex-row">
<button aria-label="themeToggle" class="mx-1 theme-toggle" id="modeSwitcher3">
<div class="day modeIcon">
<i class="far fa-lightbulb fa-2x"></i>
</div>
<div class="night modeIcon hidden">
<i class="far fa-moon fa-2x"></i>
</div>
</button>
<button aria-label="Category chooser" class="catChooser hidden ml-5" id="">
<i class="fas fa-paw fa-2x"></i>
</button>
</div>
</div>
<main class="lg:mt-10 lg:pt-5 mx-auto md:w-5/6">
<div class="hidden fixed z-10 inset-0 overflow-y-auto" id="catModal">
<div class="flex items-end justify-center text-center min-h-screen pb-80 px-4 md:block md:p-0">
<div aria-hidden="true" class="fixed inset-0 transition-opacity">
<div class="absolute inset-0 bg-gray-500 opacity-75"></div>
</div>
<span aria-hidden="true" class="hidden sm:inline-block sm:align-middle md:h-screen">​</span>
<div aria-labelledby="modal-headline" aria-modal="true" class="inline-block align-bottom bg-white border-4 border-gray-50 rounded-xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle" role="dialog">
<div class="bg-gradient-to-t from-blue-300 to-yellow-300 px-5 py-5">
<div class="text-center">
<h3 class="text-2xl font-medium leading-8 md:leading-6 pb-2 text-gray-700" id="modal-headlinemd">
                  Which categories do you want to see?
                </h3>
<hr class="border -ml-6 -mr-6 border-blue-500 border-4 mt-2 mb-4"/>
<div class="flex items-center flex-row space-x-4 justify-center text-base my-auto text-gray-700" id="" role="group">
<button class="text-xl py-1 px-2 py-0 mx-0 bg-none rounded-xl hover:text-gray-50 hover:bg-yellow-500 border-0 outline-none focus:shadow-outline" id="chooseBoth">All</button>
<button class="text-xl py-1 px-2 bg-none rounded-xl hover:text-gray-50 hover:bg-yellow-500 outline-none focus:shadow-outline active:bg-red-500" id="chooseTechnical">Technical</button>
<button class="text-xl py-1 px-2 bg-none rounded-xl hover:text-gray-50 hover:bg-yellow-500 outline-none focus:shadow-outline" id="chooseNonTechnical">Non-Technical</button>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="hidden fixed z-10 inset-0 overflow-y-auto" id="keyboardShortcuts">
<div class="flex items-end justify-center text-center min-h-screen pb-80 px-4 md:block md:p-0">
<div aria-hidden="true" class="fixed inset-0 transition-opacity">
<div class="absolute inset-0 bg-gray-500 opacity-75"></div>
</div>
<span aria-hidden="true" class="hidden sm:inline-block sm:align-middle md:h-screen">​</span>
<div aria-labelledby="modal-headline" aria-modal="true" class="inline-block align-bottom bg-white border-4 border-gray-50 rounded-xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle" role="dialog">
<div class="px-5 py-5">
<div class="">
<h3 class="text-2xl font-medium leading-8 md:leading-6 pb-2 text-gray-700" id="modal-headlinemd">
                 Keyboard Shortcuts:
                </h3>
<hr class=""/>
<div class="flex flex-row space-x-4 text-base text-gray-700" id="" role="group">
<div class="markdown">
<ul class="text-black text-base leading-loose">
<li class="list-none pb-1"><code>?</code><span class="ml-2">toggle shortcut descriptions</span></li>
<li class="list-none pb-1"><code>/</code><span class="ml-2"> search</span></li>
<li class="list-none pb-1"><code>j</code><span class="ml-2"> scroll down</span></li>
<li class="list-none pb-1"><code>k</code><span class="ml-2"> scroll up</span></li>
<li class="list-none pb-1 -ml-2"><code>tt</code><span class="ml-2"> toggle dark theme</span></li>
<li class="list-none pb-1 -ml-2"><code>gi</code><span class="ml-2"> go to blog index page</span></li>
<li class="list-none pb-1 -ml-2"><code>gn</code><span class="ml-2"> go to next article</span></li>
<li class="list-none pb-1 -ml-2"><code>gp</code><span class="ml-2"> go to previous article</span></li>
<li class="list-none pb-1 -ml-2"><code>gf</code><span class="ml-2"> go forwards</span></li>
<li class="list-none pb-1 -ml-2"><code>gb</code><span class="ml-2"> go to previous page</span></li>
<li class="list-none pb-1 -ml-2"><code>gc</code><span class="ml-2"> go to categories page</span></li>
<li class="list-none pb-1 -ml-2"><code>go</code><span class="ml-2"> go to article's category page</span></li>
<li class="list-none pb-1 -ml-2"><code>ga</code><span class="ml-2"> go to about page</span></li>
<li class="list-none pb-1 -ml-2"><code>ge</code><span class="ml-2"> go to experience page</span></li>
<li class="list-none pb-1 -ml-2"><code>gr</code><span class="ml-2"> go to portfolio page</span></li>
<li class="list-none pb-1 -ml-2"><code>gl</code><span class="ml-2"> go to landing page</span></li>
<li class="list-none pb-1 -ml-2"><code>vt</code><span class="ml-2"> only show technical articles on blog index page</span></li>
<li class="list-none pb-1 -ml-2"><code>vn</code><span class="ml-2"> only show non-technical articles on blog index page</span></li>
<li class="list-none pb-1 -ml-2"><code>va</code><span class="ml-2"> show articles from all categories on blog index page</span></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="hidden fixed z-10 inset-0 overflow-y-auto" id="fuseModal">
<div class="flex items-start justify-center text-center min-h-screen pb-80 px-4 md:block md:p-0" id="searchModalBackground">
<div aria-hidden="true" class="fixed inset-0 transition-opacity">
<div class="absolute inset-0 bg-gray-500 opacity-75"></div>
</div>
<div class="absolute inset-x-0 w-screen px-3">
<div aria-labelledby="modal-headline" aria-modal="true" class="w-full md:w-10/12 lg:w-8/12 mt-5 lg:mt-20 inline-block align-bottom bg-white border-4 border-gray-50 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle" role="dialog">
<div class="py-1 px-1">
<input class="mt-5 mb-3 px-3 mb-5 w-full text-gray-800 text-xl font-semibold border-2 border-gray-200 rounded-lg" id="searchBox" style="outline:0;" type="text"/>
<div class="hidden lg:inline-flex flex">
<div class="width-12 mx-1 px-2 text-gray-500 border border-gray-300 rounded-lg">
                    /
                  </div>
                  or
                  <div class="width-12 mx-1 px-2 text-gray-500 border border-gray-300 rounded-lg">
                    cmd-K
                  </div>
</div>
<ul class="results text-lg text-bold text-gray-600" id="searchResults">
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="mx-auto w-full">
<div class="flex flex-row">
<div class="hidden xl:inline xl:w-32">
<div class="w-32">
<div class="mt-5 2xl:mt-20 fixed flex flex-col">
<div class="lg:w-32">
<div>
<a class="my-2 prose prose-xl leading-8 text-gray-700 dark:text-gray-200 hover:underline font-semibold block md:inline-block" href="https://johnmathews.eu/index.html"><i class="far fa-md fa-star"></i></a>
</div>
<div>
<a class="text-lg my-2 text-gray-700 dark:text-gray-200 hover:underline font-semibold block md:inline-block" href="https://johnmathews.eu/blog.html">Blog</a>
</div>
<div id="searchButton"> <a class="text-lg my-2 text-gray-700 dark:text-gray-200 hover:underline font-semibold block md:inline-block" href="javaScript:;">Search</a> </div>
<a class="text-lg my-2 text-gray-700 dark:text-gray-200 hover:underline font-semibold block md:inline-block" href="https://johnmathews.eu/portfolio.html">Portfolio</a>
<a class="text-lg my-2 text-gray-700 dark:text-gray-200 hover:underline font-semibold block md:inline-block" href="https://johnmathews.eu/about.html">About</a>
<a class="text-lg my-2 text-gray-700 dark:text-gray-200 hover:underline font-semibold block md:inline-block" href="https://johnmathews.eu/experience.html">Experience</a>
<div class="flex my-2">
<button aria-label="themeToggle" class="md:pl-0 my-2 theme-toggle" id="modeSwitcher2">
<div class="day modeIcon">
<i class="far fa-lightbulb fa-lg"></i>
</div>
<div class="night modeIcon hidden">
<i class="far fa-moon fa-lg"></i>
</div>
</button>
</div>
<div class="-mr-10 border-t-4 border-double border-gray-800 dark:border-gray-100 mt-20">
</div>
<div class="pt-20 font-serif text-lg text-gray-700 font-bold dark:text-gray-300">
    Published: <br/> June 2017
  </div>
<div class="pt-5 font-serif text-lg text-gray-700 font-bold dark:text-gray-300">
    Category:<br/>
<a href="https://johnmathews.eu/category/technical/web.html">Web</a>
</div>
</div>
</div>
</div>
</div>
<div class="w-full xl:w-5/6 xl:ml-20" id="contentParent">
<div class="mx-3 xl:ml-20 my-4 technical" id="articleParent">
<img alt="Pelican blogging platform" class="image-process-article-leading-image xl:-mt-5 my-5 lg:max-w-3xl 2xl:max-w-4xl" sizes="(min-width: 1535x) 1200px, (min-width: 1280px) 900px, (min-width: 1024px) 1000px, (min-width: 768px) 800px, (min-width: 640px) 720px, 100vw" src="/images/derivatives/article-leading-image/900w/get_pelican.png" srcset="/images/derivatives/article-leading-image/1200w/get_pelican.png 1200w, /images/derivatives/article-leading-image/1000w/get_pelican.png 1000w, /images/derivatives/article-leading-image/900w/get_pelican.png 900w, /images/derivatives/article-leading-image/800w/get_pelican.png 800w, /images/derivatives/article-leading-image/720w/get_pelican.png 720w"/>
<div class="mb-10">
<div class="markdown prose prose-md lg:prose-xl xl:prose-2xl leading-tight text-left mt-24 lg:-mr-30 xl:-mr-40 text-5xl md:text-6xl lg:text-8xl 2xl:text-9xl font-semibold lg:font-normal dark:text-gray-200" style="">
<span class="break-all" style="word-break: unset; white-space: wrap;">
          Blogging with Pelican: Design, Plugins, Sharing
        </span>
</div>
<div class="lg:hidden mt-20 text-lg font-serif font-bold text-gray-700 dark:text-gray-200">
        Category:
          <a href="https://johnmathews.eu/category/technical/web.html">Web</a>
</div>
<div class="lg:hidden text-lg font-serif font-light text-gray-600 dark:text-gray-200">
        June 2017
      </div>
</div>
<div class="mt-5 md:mt-20 md:mb-10 2xl:mt-40 2xl:mb-10 border-b-0 border-gray-600 dark:border-gray-200 border-double">
</div>
<main class="lg:w-4/6">
<article class="">
<div class="markdown"> <p>My site is optimised for speed and clarity. I’ve added share buttons using a plugin which I modified and improved, and added meta tags to control how Twitter and Facebook show my articles in feeds.</p> </div> <div class="markdown">
<h2 id="design">Design</h2>
<p>My approach to building my blog is to keep it as simple as possible, only adding features when they make a significant improvement to how the content is understood and used. Therefore I’ve done away with several features that would normally come baked into a WordPress theme. For example a footer full of links that would never be used, and a sidebar full of distractions. </p>
<p>I opted for a single column design that hopefully presents text-heavy articles clearly and intuitively (please leave a comment and tell me what you think).</p>
<h2 id="plugins">Plugins</h2>
<p>My use of plugins to extend Pelican’s functionality reflects this, there is the <a href="https://github.com/getpelican/pelican-plugins/tree/master/neighbors">Neighbors</a> plugin so that the next or previous post can be accessed from the bottom of a post without going back to the index, and the <a href="https://github.com/getpelican/pelican-plugins/tree/master/tag_cloud">Tag Cloud</a> plugin to reflect which subjects are written about the most (and provide a link to all relevant articles).</p>
<h2 id="speed">Speed</h2>
<p>The speed of the site is important because a faster site is more enjoyable to use. Therefore I’ve minified the <span class="caps">CSS</span> and the JavaScript using the <a href="https://github.com/getpelican/pelican-plugins/tree/master/assets">Assets</a> plugin. I’ve also set the <span class="caps">CSS</span> and JavaScript to load asynchronously. Images are optimised using the <a href="https://github.com/getpelican/pelican-plugins/tree/master/optimize_images">Optimize Images</a> plugin so that their file size is as small as possible and they download quickly. The site uses CloudFlare’s free <span class="caps">CDN</span> features so hopefully no matter when you view the site from you get a decent page speed.</p>
<h2 id="jinja-templates">Jinja templates</h2>
<p>I’ve also arranged the homepage so that posts are shown by their category and then by posting date. This may not work very well with a larger number of posts, but I’ll only consider that problem once it presents itself. Designing for hypotheticals or conditions that don’t yet exist is a waste of time. </p>
<p>There are examples of how I’ve used Jinja templates below in the context of sharing my articles on Twitter and Facebook.</p>
<h2 id="plugin-share-post">Plugin: Share Post</h2>
<p>I noticed that my posts were beginning to get tweeted about, so I thought it would be useful to have some sharing buttons at the bottom of each post for Twitter, Facebook and Email. Looking at the Pelican Plugins repo on Github showed there was (as usual) a plugin for this (called <a href="https://github.com/getpelican/pelican-plugins/tree/master/share_post">Share Post</a>), though I noted it hadn’t been updated for a couple of years.</p>
<p>Installing and initial set-up was simple thanks to the readme on the git repo. You need to copy the plugin folder to the plugins directory, and add the name of the plugin to the list in pelicanconf.py. Then you need to copy paste some Jinja/<span class="caps">HTML</span> into the article.html template. That’s enough to make it work.</p>
<p>I noted though that when I shared to Twitter the text to be tweeted was encapsulated in quotes and there was a ‘b’ at the front. I realised this was due to using Python 3.x when the plugin (which hadn’t been updated for 2 years) was likely written for Python 2.x. A quick google and the obligatory trip to <span class="caps">SO</span> showed me how to convert a bytes string to a normal text string. </p>
<div class="highlight"><pre><span></span><span class="c1"># Python 2</span>
<span class="n">tweet</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'</span><span class="si">%s%s</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">url</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">)</span>

<span class="c1"># Python 3</span>
<span class="n">tweet_as_byte</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'</span><span class="si">%s%s</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">url</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">)</span>
<span class="n">tweet</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">tweet_as_byte</span><span class="p">,</span><span class="s1">'utf-8'</span><span class="p">)</span>
</pre></div>
<p>I also found that an article couldn’t be shared to twitter from a mobile device and this was due to the <span class="caps">URL</span> being incorrectly formatted. The new <span class="caps">URL</span> format required separate arguments for the <span class="caps">URL</span>, additional text and the twitter handle:</p>
<div class="highlight"><pre><span></span><span class="c1"># Incorrect</span>
<span class="n">twitter_link</span> <span class="o">=</span> <span class="s1">'http://twitter.com/home?status=</span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="n">tweet</span>

<span class="c1"># Correnct</span>
<span class="n">twitter_link</span> <span class="o">=</span> <span class="s1">'http://twitter.com/share?url=</span><span class="si">%s</span><span class="s1">&amp;text=</span><span class="si">%s</span><span class="s1">&amp;via=</span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">tweet</span><span class="p">,</span> <span class="n">t_handle</span><span class="p">)</span>
</pre></div>
<h2 id="using-meta-data-to-specify-tweet-text">Using meta-data to specify tweet text</h2>
<p>I thought it would be cool to add some default text to a tweet, as I’ve enjoyed this feature on other blogs when I’ve found a post I wanted to share on Twitter. - A user may know they want to share an article but if they’re in a hurry it might be hard to find the right words, so why not provide a ready-made tweet. The text is editable so it’s only a suggestion.</p>
<p>The text would be different for each post so it makes sense to specify it when writing the article. The article ‘summary’ would be too long, and I know that Pelican supports arbitrary meta-data tags. I assumed that Jinja would pick up the data the same way it picks up the ‘standard’ meta-data and added a function to share_post.py.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">article_tweet</span><span class="p">(</span><span class="n">content</span><span class="p">):</span>
    <span class="n">tweet</span> <span class="o">=</span> <span class="s1">''</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="s1">'tweet'</span><span class="p">):</span>
        <span class="n">tweet</span> <span class="o">=</span>  <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">tweet</span><span class="p">,</span> <span class="s1">'html.parser'</span><span class="p">)</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">quote</span><span class="p">((</span><span class="s1">'</span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">tweet</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">' '</span> 
</pre></div>
<p>Once this function was working it was simply a case of calling the function and assigning the output to a variable I called “Tweet”, and then adding “Tweet” to the text string to be included in a tweets text:</p>
<div class="highlight"><pre><span></span>    <span class="n">tweet</span> <span class="o">=</span> <span class="n">article_tweet</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
    <span class="n">tweet_as_byte</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'</span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">tweet</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">)</span>
    <span class="n">tweet</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">tweet_as_byte</span><span class="p">,</span><span class="s1">'utf-8'</span><span class="p">)</span>
    <span class="n">t_handle</span> <span class="o">=</span> <span class="n">twitter_handle</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</pre></div>
<p>There was a bit of fiddling around to make sure that the number of spaces between each part of the tweet was correct, but nothing as complicated as when making <a href="https://johnmathews.eu/time-until.html">Time Until</a>.</p>
<h2 id="specifying-the-text-and-image-in-a-facebook-share">Specifying the text and image in a Facebook share</h2>
<p>Sharing to Facebook worked without any formatting problems, but it bugged me that the opening text of the article was being used in the preview that was shared to Facebook when I had a summary already prepared and that would be much more useful to potential readers. For some articles I also had an article image that I wanted to see being used. </p>
<p>Googling revealed that I needed to use particular meta tags in the webpage’s header if I wanted to control what Facebook would pickup. Facebook uses the “open graph” standards so I would need the headers in my article pages to include the following: </p>
<div class="highlight"><pre><span></span>`<span class="c">&lt;!-- Open Graph data --&gt;</span>`
`<span class="p">&lt;</span><span class="nt">meta</span> <span class="na">property</span><span class="o">=</span><span class="s">"og:title"</span> <span class="na">content</span><span class="o">=</span><span class="s">"Title Here"</span> <span class="p">/&gt;</span>`
`<span class="p">&lt;</span><span class="nt">meta</span> <span class="na">property</span><span class="o">=</span><span class="s">"og:type"</span> <span class="na">content</span><span class="o">=</span><span class="s">"article"</span> <span class="p">/&gt;</span>`
`<span class="p">&lt;</span><span class="nt">meta</span> <span class="na">property</span><span class="o">=</span><span class="s">"og:url"</span> <span class="na">content</span><span class="o">=</span><span class="s">"http://www.example.com/"</span> <span class="p">/&gt;</span>`
`<span class="p">&lt;</span><span class="nt">meta</span> <span class="na">property</span><span class="o">=</span><span class="s">"og:image"</span> <span class="na">content</span><span class="o">=</span><span class="s">"http://example.com/image.jpg"</span> <span class="p">/&gt;</span>`
`<span class="p">&lt;</span><span class="nt">meta</span> <span class="na">property</span><span class="o">=</span><span class="s">"og:description"</span> <span class="na">content</span><span class="o">=</span><span class="s">"Description Here"</span> <span class="p">/&gt;</span>
</pre></div>
<p>I could see that I already had some meta tags being generated using the Jinja templates so I set about copy-pasting and modifying them to build the new tags. I had some issues with trailing white space or line breaks being included within the content string. This was solved like so:</p>
<div class="highlight"><pre><span></span><span class="c">{# Adding '-' after and before the %'s strips white space and line breaks #}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">description</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">    </span><span class="cp">{%</span>- <span class="k">if</span> <span class="nv">article.summary</span> -<span class="cp">%}</span><span class="x"></span>
<span class="x">        </span><span class="cp">{{</span> <span class="nv">article.summary</span><span class="o">|</span><span class="nf">striptags</span><span class="o">|</span><span class="nf">truncate</span><span class="o">(</span><span class="m">200</span><span class="o">)|</span><span class="nf">e</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">    </span><span class="cp">{%</span>- <span class="k">else</span> -<span class="cp">%}</span><span class="x"></span>
<span class="x">        </span><span class="cp">{{</span> <span class="nv">article.content</span><span class="o">|</span><span class="nf">striptags</span><span class="o">|</span><span class="nf">truncate</span><span class="o">(</span><span class="m">200</span><span class="o">)|</span><span class="nf">e</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">    </span><span class="cp">{%</span>- <span class="k">endif</span> -<span class="cp">%}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="nv">description</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
<p>I also needed to use some blocks more than once, because a description tag was already included but Facebook wants an “og:description”, and Twitter wants a “Twitter:Description” too. All three of these tags will include the same text (generated in the Jinja2 snippet above). If a block only needs to be used once then it’s generated like this; </p>
<div class="highlight"><pre><span></span><span class="x">&lt;meta name="description" content="</span><span class="cp">{%</span> <span class="k">block</span> <span class="nv">description</span> <span class="cp">%}{%</span> <span class="k">endblock</span> <span class="nv">description</span> <span class="cp">%}</span><span class="x">"&gt;</span>
</pre></div>
<p>But If you call “{% block description %}{% endblock description %}” again Jinja will throw you an error. The documentation (and <span class="caps">SO</span>) reveal that the solution is to use:</p>
<div class="highlight"><pre><span></span><span class="x">&lt;meta property="og:description" content="</span><span class="cp">{{</span> <span class="nv">self.description</span><span class="o">()</span> <span class="cp">}}</span><span class="x">"&gt;</span>
</pre></div>
<p>This allows you to reuse blocks multiple times and keep your templates tidy.</p>
<p>Finally, when I was testing Facebook to see if the correct text or image was being picked up I was initially frustrated to see that the new tags were not having any effect. This is because Facebook crawls your site and saves what it finds. If you want it to take a fresh look at your page with its new meta tags, you need to tell Facebook to crawl the page again, using the <a href="https://developers.facebook.com/tools/debug/">Facebook linter/debugger</a>.  </p>
<p>You can see the new sharing buttons below, please click them and see what happens!</p>
<p>Note: My first article describing how I began to use Pelican is <a href="https://johnmathews.eu/pelican.html">here</a></p>
</div>
</article>
</main>
<div class="mt-20 mb-10 text-lg dark:text-gray-200">
<div class="flex flex-row">
<div class="text-red-500 dark:text-red-500"> ←  </div>
<a class="font-serif text-lg font-extrabold dark:text-gray-300 px-1 hover:text-red-500 dark:hover:text-red-500" href="https://johnmathews.eu/pelican.html" id="previousArticleInCategory"> Blogging with Pelican</a>
</div>
<div class="flex flex-row mt-2">
<div class="text-green-500 dark:text-green-200"> → </div>
<a class="font-serif text-lg font-extrabold dark:text-gray-300 text-left px-1 hover:text-green-500 dark:hover:text-green-200" href="https://johnmathews.eu/a-new-blog-design.html" id="nextArticleInCategory"> A New Blog Design</a>
</div>
<div class="mt-2 font-serif text-lg text-gray-700 font-bold dark:text-gray-300">
<div class="">
<a class="text-blue-600 dark:text-blue-300 font-serif text-lg font-bold" href="https://johnmathews.eu/category/technical/web.html" id="otherArticlesInCategory">Other articles in this category</a>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</main>
<footer class="footer w-5/6 mx-auto border-t-2 border-single border-gray-200 mt-10 py-3">
<div class="text-center font-serif text-lg text-gray-700 dark:text-gray-200">
<a class="px-3" href="https://johnmathews.eu/blog.html">Blog Posts</a> |
        <a class="px-3" href="#top">Back to top</a> |
        <a class="px-3" href="https://johnmathews.eu/categories.html">Categories</a> |
        <a class="px-3" href="https://johnmathews.eu/feeds/all.atom.xml">RSS</a> |
        <a class="px-3" href="JavaScript:void(0)" id="viewShortcuts">Shortcuts</a>
</div>
</footer>
<script>
        const light = "https://johnmathews.eu/theme/css/pygment-light.css"
        const dark = "https://johnmathews.eu/theme/css/pygment-dark.css"
        const indexURL = 'https://johnmathews.eu/fuse.html'
        const siteURL = 'https://johnmathews.eu'
      </script>
<script crossorigin="anonymous" src="https://johnmathews.eu/theme/js/categoryChooser.js" type="module"></script>
<script crossorigin="anonymous" src="https://johnmathews.eu/theme/js/navbar.js" type="text/javascript"></script>
<script crossorigin="anonymous" src="https://johnmathews.eu/theme/js/fuseSearch.js" type="module"></script>
<script crossorigin="anonymous" src="https://johnmathews.eu/theme/js/keyboard-shortcuts.js" type="module"></script>
<script crossorigin="anonymous" src="https://johnmathews.eu/theme/js/themeChooser.js" type="module"></script>
<script>
    const technical = $( "#articleParent" ).hasClass('technical');
    const nonTechnical = $( "#articleParent" ).hasClass('nonTechnical');

    // if user preference for article category has been set and is contradicted by currenct article, update it
    if (localStorage.getItem('categoryChoice') === "technical") {
      if (nonTechnical) {
        window.localStorage.setItem('categoryChoice', 'all');
      };
    } else if (localStorage.getItem('categoryChoice') === "nonTechnical") {
      if (technical) {
        window.localStorage.setItem('categoryChoice', 'all');
      };
    } else if (localStorage.getItem('categoryChoice') === "all") {
      // do nothing
    } else {
      // if user preference for article category hasn't been set, assign it using article type
      if (technical) {
        window.localStorage.setItem('categoryChoice', 'technical');
      } else if (nonTechnical) {
        window.localStorage.setItem('categoryChoice', 'nonTechnical');
      };
    }
  </script>
</body>
</html>