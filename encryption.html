<!doctype html>
<html lang="en">
  <head>
        <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

      <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
      <!--[if lt IE 9]>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
      <![endif]-->

      <title> Encryption -  blog  </title>
      <meta name="title" content=" Encryption -  blog  " />
      <meta property="og:title" content="Encryption" />
      <meta property="twitter:title" content="Encryption " />

      <meta name="keywords" content=" Bitcoin,Blockchains,Digital Currencies,DLT,Encryption,Public Key Cryptography,RSA " />
      <meta name="author" content="John Mathews" />
      <meta name="twitter:creator" content="@johnmathews" />

      <meta name="description" content="Blockchains use Elliptical Curve Cryptography (ECC) to authenticate users and authorise transactions. These notes introduce the field of cryptography and explains how modern cryptographic methods..." />
      <meta name="twitter:description" content="Blockchains use Elliptical Curve Cryptography (ECC) to authenticate users and authorise transactions. These notes introduce the field of cryptography and explains how modern cryptographic methods..." />
      <meta property="og:description" content="Blockchains use Elliptical Curve Cryptography (ECC) to authenticate users and authorise transactions. These notes introduce the field of cryptography and explains how modern cryptographic methods..." />

      <meta property="og:url" content="./encryption.html" />
      <meta property="twitter:url" content="./encryption.html" />

      <meta name="twitter:image" content="./ " />
      <meta property="og:image" content="./ " />

      <meta property="twitter:card" content="summary" />
      <meta name="twitter:domain" content="https://blog.johnmathews.eu" />

      <meta property="og:type" content="article" />

      <link rel="icon" href="./favicon.png" />


      <link href="./theme/css/styles.css" rel="stylesheet" />
      <link href="./theme/css/pygment.css" rel="stylesheet" />


  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin="anonymous" />

  <link href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css" rel="stylesheet" type="text/css">
  <style type="text/css">
      #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
      /* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
         We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
  </style>
  </head>

  <body>
    <a class="pt-20 mt-20 " name="top"></a>
    <nav class="top-0 w-full md:fixed flex flex-wrap items-center justify-between p-5 bg-green-500 text-xl">
      <div>
        <a href="." class="prose prose-xl text-gray-700 hover:text-white font-semibold block md:inline-block px-3 py-3">
          John Mathews' Blog
        </a>
      </div>
      <div class="flex md:hidden">
        <button id="hamburger">
          <img class="toggle block" src="https://img.icons8.com/fluent-systems-regular/2x/menu-squared-2.png" width="40" height="40" />
          <img class="toggle hidden" src="https://img.icons8.com/fluent-systems-regular/2x/close-window.png" width="40" height="40" />
        </button>
      </div>
      <div class="toggle hidden md:flex w-full md:w-auto text-right text-bold mt-5 md:mt-0 border-t-2 border-blue-900 md:border-none">
        <a class="prose prose-xl text-gray-700 hover:text-white font-semibold block md:inline-block px-3 py-3 border-b-2 border-blue-900 md:border-none" href="https://johnmathews.eu/about.html">About</a>
        <a class="prose prose-xl text-gray-700 hover:text-white font-semibold block md:inline-block px-3 py-3 border-b-2 border-blue-900 md:border-none" href="https://johnmathews.eu/experience.html">Experience</a>
        <a class="prose prose-xl text-gray-700 hover:text-white font-semibold block md:inline-block px-3 py-3 border-b-2 border-blue-900 md:border-none" href="mailto:mthwsjc@gmail.com">Contact</a>
      </div>
    </nav>

    <main class="md:mt-20 md:pt-5">

  <div class="mx-auto max-w-4xl px-10 my-4 py-6 bg-white rounded-lg shadow-md">
    <div class="">

      <div class="markdown">
        <h1> Encryption </h1>
      </div>

      <div class="py-1 text-gray-700 font-bold">
        By John Mathews
      </div>

      <div class="font-light text-gray-600 pb-5">
        August 2016
      </div>

      <div class="markdown">
        <p>Blockchains use Elliptical Curve Cryptography (<span class="caps">ECC</span>) to authenticate users and authorise transactions. These notes introduce the field of cryptography and explains how modern cryptographic methods work. I wrote them to teach myself about encryption <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup></p>
<p>To begin with the absolute basics, encryption generally works by taking a message and representing …</p>
        <p>Blockchains use Elliptical Curve Cryptography (<span class="caps">ECC</span>) to authenticate users and authorise transactions. These notes introduce the field of cryptography and explains how modern cryptographic methods work. I wrote them to teach myself about encryption <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup></p>
<p>To begin with the absolute basics, encryption generally works by taking a message and representing it as a series of numbers <sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup> which are then turned into a series of random looking numbers. Decryption works by turning the random looking numbers back into the original&nbsp;message.</p>
<h2>Background</h2>
<p>The history of Cryptography can be split into classical and modern eras. Modern cryptography began in 1977 with the introduction of the <span class="caps">RSA</span> and Diffie-Hellman algorithms.  Until then, Cryptography required using a single key (the secret code) to encrypt and decrypt the message. This was transferred from sender to receiver secretly, but not cryptographically. In classical cryptography, the code is a <em>shared</em>&nbsp;secret.</p>
<p>The modern era removed the requirement for a shared secret and instead used number theory as a basis for quantifying the strength of an encryption method. The strength of a modern cryptographic technique is quantifiable and provable by reference to number theory, rather than a users ability to transport or transfer a secret&nbsp;code.</p>
<p>Modern cryptography is defined by Public Key Cryptographic systems. They use one key (code) for encryption and another for decryption. The encryption key can be made public without any risk of the message being decrypted, and is therefore known as the public key. The key used to decrypt data is the private key, and must not be revealed. If a message is encrypted with the public key it can only be decrypted with the private&nbsp;key.</p>
<p>Public Key Cryptographic (<span class="caps">PKC</span>) systems use algorithms that are easy to process in one direction but difficult to reverse, which are known as mathematical trap-door functions. A simple example of a trap-door function is the product of two prime numbers. If two random prime numbers are chosen, it is trivial to find their product. However if only the product of the two numbers is known, it is relatively difficult to find either of the factors used to create the number (this is factorisation). This was first noticed in 1874, when <a href="https://en.wikipedia.org/wiki/William_Stanley_Jevons#Jevons.27_number">Jevons</a>&nbsp;remarked:</p>
<blockquote>
<p><span class="dquo">&#8220;</span>Can the reader say what two numbers multiplied together will produce the number 8,616,460,799? I think it unlikely that anyone but myself will ever&nbsp;know.&#8221;*</p>
</blockquote>
<p>This simple problem shows that finding the product of two (secret) prime numbers is computationally simple, but factorising the result is not. This type of problem is a key feature of modern cryptography. Factoring prime numbers is a super famous mathematical problem, it was studied by <a href="https://en.wikipedia.org/wiki/Eratosthenes">Eratosthenes</a> <sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup> in the 3rd century <span class="caps">BC</span> and more recently the <a href="https://en.wikipedia.org/wiki/RSA_Factoring_Challenge"><span class="caps">RSA</span> Factoring Challenge</a> has intended to track state-of-the-art factorisation techniques by issues cash prizes for the factorisation of products of large&nbsp;primes.</p>
<p>Generally, the bigger the difference in difficulty between executing the function and reversing it, the better the cryptographic&nbsp;technique.</p>
<p>The <span class="caps">RSA</span> algorithm below uses factorisation as the foundation of its security, but factorisation is not the hardest problem to solve relative to the size of the keys required. Algorithms have been developed to factor the products of large prime numbers, and are much more efficient than randomly guessing possible factors. The greater the size of the primes being factored, the more efficient these algorithms become, and therefore the difference in difficulty between executing the function (multiplying two large primes) and reversing it (factorisation) becomes smaller as the size of the cryptographic key length increases. This is a problem because as public key cryptography becomes more commonly used the resources available to factor products of primes increases, and consequently larger keys are&nbsp;required.</p>
<p>Ultimately, encryption techniques based on the difficulty of factorisation will become redundant as the difficulty gap between creating and solving them shrinks. A better trap door function is&nbsp;required.</p>
<h2>Overview of the <span class="caps">RSA</span>&nbsp;algorithm</h2>
<p>Named after its founders (<a href="https://en.wikipedia.org/wiki/Ron_Rivest" title="Ron Rivest">Ron Rivest</a>, <a href="https://en.wikipedia.org/wiki/Adi_Shamir" title="Adi Shamir">Adi Shamir</a>, and <a href="https://en.wikipedia.org/wiki/Leonard_Adleman" title="Leonard">Leonard Adleman</a>), <span class="caps">RSA</span> was one of the first public-key encryption algorithms and is still widely&nbsp;used.</p>
<p><span class="caps">RSA</span> (as well as other cryptographic techniques) makes use of a number line which loops back to zero after reaching a maximum value, rather than increasing indefinitely. This means that once a maximum number $n$ has been defined, if a number greater than $n$ is created the result simply loops around to 0 and begins counting from 0 again. i.e. if $n = 10$, then $7 + 5 = 12 - 10 = 2$. The result of a calculation on a looping number line may easily be found by doing long division and using the remainder as the final answer, i.e. $12 / 10 = 1$ with $2$&nbsp;remaining.</p>
<h2>Generation of a pair of <span class="caps">RSA</span>&nbsp;keys:</h2>
<h3>1. Generate the <span class="caps">RSA</span>&nbsp;module</h3>
<ul>
<li>Select two large random prime numbers, $p$ and $q$. They need to be random because anyone who knows or guesses them will be able to decrypt the&nbsp;encryption.</li>
<li>Calculate $n =&nbsp;pq$</li>
</ul>
<h3>2. Find derived number&nbsp;(e)</h3>
<ul>
<li><em>e</em> must be greater than 1 and less than $( p - 1)( q -&nbsp;1)$.</li>
<li>There must be no common factor for e and $( p - 1)( q - 1)$ except for 1. <sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup></li>
</ul>
<h3>3. Form the public&nbsp;key</h3>
<ul>
<li>The pair of numbers $(n, e)$ form the public key and can be made&nbsp;public.</li>
<li>Even though $n$ is public, it is so difficult to factor the product of 2 large prime numbers that an attacker would not be able to find its component primes in the time available. The strength of <span class="caps">RSA</span> rests entirely on the difficulty of factoring $n$ into its two component prime&nbsp;numbers.</li>
</ul>
<h3>4. Generate the private key&nbsp;(d)</h3>
<ul>
<li>The private key is generated from using $p$, $q$ and e as inputs to the Extended Euclidean Algorithm. For a given set of values, there is a unique answer&nbsp;$d$.</li>
<li>$d$ is the inverse of $e$ modulo $( p - 1)( q - 1 )$. This means that $d$ is the number less than $( p - 1 ) ( q - 1 )$ such that when it is multiplied by e, it is equal to $1$ modulo $( p - 1 ) ( q - 1&nbsp;)$.</li>
</ul>
<h2><span class="caps">RSA</span>&nbsp;example:</h2>
<p><span class="caps">RSA</span> does not directly operate on strings as bits, it operates on numbers modulo (less than) $n$. and it is necessary to represent plain text as a series of numbers less than $n$. The dominant encoding on the internet is <a href="https://en.wikipedia.org/wiki/UTF-8"><span class="caps">UTF</span>-8</a>, which represents each upper case Latin letter as a number between 65 and 90. Using this encoding, a message &#8220;<span class="caps">HELLO</span>&#8221; would become &#8220;$72, 69, 76, 76,&nbsp;79$&#8221;.</p>
<p>The maximum number $n$ needs to be the product of the two prime numbers $p$ and $q$. For this example choose $p = 7$ and $q = 13$, so $n  = 91$  <sup id="fnref:5"><a class="footnote-ref" href="#fn:5">5</a></sup></p>
<p>The public key component <em>e</em> can be any number we choose,  as long as there is no number other than 1 which is a common factor of <em>e</em> and $( p - 1 ) ( q - 1 )$. In our example, this requires that there be no common factor between 72 and e other than 1, so let <em>e</em> $=&nbsp;5$.</p>
<p>Therefore our public key is (91, 5). This can be made available to anyone without messages being decrypted because of the difficulty of factoring the product of (very large) prime&nbsp;numbers.</p>
<p>Using the fact that we know 5 and 11 are the prime factors of 55 and e is 5, we can use the Extended Euclidean Algorithm  to compute our private key $d$, which is&nbsp;29.</p>
<p>Therefore when the prime factors 7 and 13 are used, the public key is (91, 5) and the private key is (91, 29). These parameters fully define a functional <span class="caps">RSA</span>&nbsp;system.</p>
<h3>Encoding</h3>
<p>To encode a letter H in a message (&#8216;H&#8217; is $72$ in <span class="caps">UTF</span>-8), we need to multiply it by itself $e$ times ($e = 5$), remembering to wrap around each time we pass our maximum value of $n =&nbsp;91$.</p>
<p>$72 \times 72 = 5184, 5184 / 91 = 56$ with $88$ remaining, (i.e. $5184 = 91 \times 56 + 88$). Therefore:
$72 \times 72 = 5184 = 88$
$88 \times 72 = 6336 = 57$
$57 \times 72 = 4104 = 9$
$9 \times 72 = 648 =&nbsp;11$</p>
<p>Therefore the encrypted value of &#8220;H&#8221; is&nbsp;&#8220;$11$&#8221;</p>
<p>Using the method for each character in the message &#8220;<span class="caps">HELLO</span>&#8221; results in the encoded message&nbsp;&#8220;\$11,62,20,20,53\$&#8221;.</p>
<p>To decrypt the message, we take each number and multiply it by itself $d$ times, ($d=29$) wrapping around each time we pass&nbsp;$91$.</p>
<p>$11 \times 11 = 121 = 30$
$30 \times 11 = 330 = 57$
&#8230;
$57 \times 11 = 627 = 81$
$81 \times 11 = 891 =&nbsp;72$</p>
<p>And we&#8217;re back to our original&nbsp;encoding.</p>
<h2>Files</h2>
<p>The spreadsheet I used to calculate the encrypted and decrypted values can be downloaded <a href="./RSA-Example.xlsx">here</a>.</p>
<p>A simple python script to encrypt and decrypt a message is <a href="./AES_Example.py">here</a>. It uses the <span class="caps">AES</span> encryption&nbsp;method.</p>
<h3>Footnotes</h3>
<div class="footnote">
<hr>
<ol>
<li id="fn:1">
<p>I used the explanations <a href="http://www.tutorialspoint.com/cryptography/public_key_encryption.htm">here</a> and <a href="https://blog.cloudflare.com/a-relatively-easy-to-understand-primer-on-elliptic-curve-cryptography/">here</a> a lot.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>A simple example is $A=1, B=2$ etc&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p>Eratosthenes invented his famous <a href="https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes">sieving algorithm</a> which finds all the primes up to a given limit.&#160;<a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:4">
<p>If this is the case then e and ( p - 1) ( q - 1 ) are called &#8220;coprime&#8221;&#160;<a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:5">
<p>Whilst the Extended Euclidean Algorithm is apparently simple to compute, its description is not. Therefore I&#8217;ve used the same numbers in the following example as in the tutorials <a href="http://www.tutorialspoint.com/cryptography/public_key_encryption.htm">here</a> and <a href="http://arstechnica.com/security/2013/10/a-relatively-easy-to-understand-primer-on-elliptic-curve-cryptography/">here</a>.&#160;<a class="footnote-backref" href="#fnref:5" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
</ol>
</div>
      </div>

      <div class="border border-gray-300 mt-10 mb-10"></div>

        <div class="prose prose-lg hover:text-red-500">
            <div class="flex flex-row">
              <div> ⬅  </div>
              <a class="px-1 hover:text-green-700" href="./digital-currencies-the-basics.html"> Digital currencies: the&nbsp;basics</a>
            </div>
            <div class="flex flex-row">
              <div> ➡ </div>
              <a class="text-right px-1 hover:text-green-700" href="./silos.html"> Silos: Introduction to my doctorate&nbsp;research</a> 
            </div>
        </div>
      </div>

      <div class="mt-5 text-left">
        <button id="signupButton" class="inline-flex items-center h-10 px-5 text-indigo-100 transition-colors duration-150 bg-indigo-700 rounded-lg focus:shadow-outline hover:bg-indigo-800">
          <span>Subscribe</span>
          <i class="py-2 pl-3 fas fa-lg fa-envelope"></i>
        </button>
      </div>

      <div class="hidden" id="subscribeBox" >
        <!-- Begin Mailchimp Signup Form -->
        <div id="mc_embed_signup">
          <form action="https://johnmathews.us15.list-manage.com/subscribe/post?u=293155ea06a261f5255378dc0&amp;id=38c1e277b4" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
            <div id="mc_embed_signup_scroll">
              <div class="mc-field-group">
                <label for="mce-EMAIL">Email Address </label>
                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
              </div>
              <div id="mce-responses" class="clear">
                <div class="response" id="mce-error-response" style="display:none"></div>
                <div class="response" id="mce-success-response" style="display:none"></div>
              </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
              <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_293155ea06a261f5255378dc0_38c1e277b4" tabindex="-1" value=""></div>
              <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
            </div>
          </form>
        </div>
        <script type='text/javascript' src='//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js'></script><script type='text/javascript'>(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';}(jQuery));var $mcj = jQuery.noConflict(true);</script>
        <!--End mc_embed_signup-->
      </div>

      <div class="container">
        <div class="justify-content-center">
          <div class="row text-center">
            <div>
            </div>
          </div>

        </div>

        <div>
        </div>
      </div>
    </div>
  </div>
    </main>

    <div class="footer">
      <div class="text-center py-3">
        <a href=".">Blog</a> |
        <a href="#top">Back to top</a>
      </div>
    </div>

    <div>
          <script async src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>
        <script>
          document.getElementById("hamburger").onclick = function toggleMenu() {
            const navToggle = document.getElementsByClassName("toggle");
            for (let i = 0; i < navToggle.length; i++) {
              navToggle.item(i).classList.toggle("hidden");
            }
          };
        </script>

  <script>
    document.getElementById("signupButton").addEventListener("click", function(e) {
          $('#signupButton').removeClass('block').addClass('hidden')
          $('#subscribeBox').removeClass('hidden').addClass('block')
        });
  </script>
    </div>
  </body>

</html>