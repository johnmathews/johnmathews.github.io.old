<!DOCTYPE html>

<html class="" id="baz" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
      <![endif]-->
<title>Encryption - JohnMathews.eu</title>
<meta content="Encryption -  JohnMathews.eu " name="title"/>
<meta content="Encryption" property="og:title"/>
<meta content="Encryption" property="twitter:title"/>
<meta content=" Bitcoin,Blockchains,Digital Currencies,DLT,Encryption,Public Key Cryptography,RSA " name="keywords"/>
<meta content="John Mathews" name="author"/>
<meta content="@johnmathews" name="twitter:creator"/>
<meta content=" Blockchains use Elliptical Curve Cryptography (ECC) to authenticate users and authorise transactions. These notes introduce the field of cryptography and explains how modern cryptographic methods... " name="description"/>
<meta content=" Blockchains use Elliptical Curve Cryptography (ECC) to authenticate users and authorise transactions. These notes introduce the field of cryptography and explains how modern cryptographic methods... " name="twitter:description"/>
<meta content=" Blockchains use Elliptical Curve Cryptography (ECC) to authenticate users and authorise transactions. These notes introduce the field of cryptography and explains how modern cryptographic methods... " property="og:description"/>
<meta content="https://johnmathews.eu/encryption.html" property="og:url"/>
<meta content="https://johnmathews.eu/encryption.html" property="twitter:url"/>
<meta content="https://johnmathews.eu/
" name="twitter:image"/>
<meta content="https://johnmathews.eu/
" property="og:image"/>
<meta content="  summary  " property="twitter:card"/>
<meta content="https://johnmathews.eu" name="twitter:domain"/>
<meta content=" article " property="og:type"/>
<link href="https://johnmathews.eu/extra/favicon.png" rel="icon"/>
<link href="https://johnmathews.eu/feeds/all.atom.xml" rel="alternate" title="John Mathews Feed" type="application/atom+xml"/>
<script>
          window.ga = window.ga || function () {
            (ga.q = ga.q || []).push(arguments);
          };
          ga.l = +new Date();
          ga("create", "UA-82253540-1", "auto");
          ga("send", "pageview");
        </script>
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link async="" href="https://fonts.googleapis.com/css2?family=Cardo&amp;display=swap" rel="stylesheet"/>
<link async="" href="https://fonts.googleapis.com/css2?family=Anonymous+Pro&amp;display=swap" rel="stylesheet"/>
<script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<link href="https://johnmathews.eu/theme/css/styles.css" rel="stylesheet">
<link href="https://johnmathews.eu/theme/css/pygment-light.css" id="PygmentCSS" media="print" onload="this.media='all'" rel="stylesheet">
<script>
        let theme = localStorage.getItem('theme');
      </script>
<script>
        // dark mode light mode switcheroo
        const light = "https://johnmathews.eu/theme/css/pygment-light.css"
        const dark = "https://johnmathews.eu/theme/css/pygment-dark.css"
      </script>
<script crossorigin="anonymous" src="https://johnmathews.eu/theme/js/themeChooser.js" type="text/javascript"></script>
</link></link></head>
<body class="dark:bg-black">
<a class="pt-20 mt-20" name="top"></a>
<nav class="d:fixed top-0 w-full flex flex-row justify-between pt-2 text-xl bg-white dark:bg-black" id="navbar" style="transition: top 0.3s ease-in-out;">
<div class="text-bold pr-3 hidden md:flex md:flex-grow xl:hidden">
<div class="mt-10 md:mt-0 flex-grow justify-between">
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1" href="https://johnmathews.eu/blog.html">Blog</a>
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1" href="javaScript:;" id="searchButton2">Search</a>
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1" href="https://johnmathews.eu/portfolio.html">Portfolio</a>
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1" href="https://johnmathews.eu/about.html">About</a>
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1" href="https://johnmathews.eu/experience.html">Experience</a>
</div>
<div class="flex-none justify-end px-2 pt-2">
<button aria-label="themeToggle" class="inline-block theme-toggle" id="modeSwitcher1">
<div class="day modeIcon">
<i class="mb-2 pb-2 far fa-lightbulb fa-lg"></i>
</div>
<div class="night modeIcon hidden">
<i class="mb-2 pb-2 far fa-moon fa-lg"></i>
</div>
</button>
<button aria-label="Category chooser" class="catChooser hidden md:mt-0 ml-5 md:pl-0" id="">
<i class="mb-2 pb-2 fas fa-paw fa-lg"></i>
</button>
</div>
</div>
<div class="flex-none md:hidden block md:inline-block">
<button aria-label="Menu" class="mx-2 my-1" id="hamburger">
<div class="toggle"><i class="fas fa-bars fa-lg"></i></div>
<div class="hidden toggle"><i class="fas fa-times fa-lg"></i></div>
</button>
</div>
</nav>
<div class="toggle hidden w-screen flex flex-col text-left mt-5">
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1 text-2xl" href="https://johnmathews.eu/blog.html">Blog</a>
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1 text-2xl" href="javaScript:;" id="searchButton3">Search</a>
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1 text-2xl" href="https://johnmathews.eu/portfolio.html">Portfolio</a>
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1 text-2xl" href="https://johnmathews.eu/about.html">About</a>
<a class="text-gray-700 dark:text-gray-200 hover:underline font-semibold px-3 py-1 text-2xl" href="https://johnmathews.eu/experience.html">Experience</a>
<div class="px-3 pt-3 flex flex-row">
<button aria-label="themeToggle" class="mx-1 theme-toggle" id="modeSwitcher3">
<div class="day modeIcon">
<i class="far fa-lightbulb fa-2x"></i>
</div>
<div class="night modeIcon hidden">
<i class="far fa-moon fa-2x"></i>
</div>
</button>
<button aria-label="Category chooser" class="catChooser hidden ml-5" id="">
<i class="fas fa-paw fa-2x"></i>
</button>
</div>
</div>
<main class="lg:mt-10 lg:pt-5 mx-auto md:w-5/6">
<div class="hidden fixed z-10 inset-0 overflow-y-auto" id="catModal">
<div class="flex items-end justify-center text-center min-h-screen pb-80 px-4 md:block md:p-0">
<div aria-hidden="true" class="fixed inset-0 transition-opacity">
<div class="absolute inset-0 bg-gray-500 opacity-75"></div>
</div>
<span aria-hidden="true" class="hidden sm:inline-block sm:align-middle md:h-screen">​</span>
<div aria-labelledby="modal-headline" aria-modal="true" class="inline-block align-bottom bg-white border-4 border-gray-50 rounded-xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle" role="dialog">
<div class="bg-gradient-to-t from-blue-300 to-yellow-300 px-5 py-5">
<div class="text-center">
<h3 class="text-2xl font-medium leading-8 md:leading-6 pb-2 text-gray-700" id="modal-headlinemd">
                  Which categories do you want to see?
                </h3>
<hr class="border -ml-6 -mr-6 border-blue-500 border-4 mt-2 mb-4"/>
<div class="flex items-center flex-row space-x-4 justify-center text-base my-auto text-gray-700" id="" role="group">
<button class="text-xl py-1 px-2 py-0 mx-0 bg-none rounded-xl hover:text-gray-50 hover:bg-yellow-500 border-0 outline-none focus:shadow-outline" id="chooseBoth">All</button>
<button class="text-xl py-1 px-2 bg-none rounded-xl hover:text-gray-50 hover:bg-yellow-500 outline-none focus:shadow-outline active:bg-red-500" id="chooseTechnical">Technical</button>
<button class="text-xl py-1 px-2 bg-none rounded-xl hover:text-gray-50 hover:bg-yellow-500 outline-none focus:shadow-outline" id="chooseNonTechnical">Non-Technical</button>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="hidden fixed z-10 inset-0 overflow-y-auto" id="keyboardShortcuts">
<div class="flex items-end justify-center text-center min-h-screen pb-80 px-4 md:block md:p-0">
<div aria-hidden="true" class="fixed inset-0 transition-opacity">
<div class="absolute inset-0 bg-gray-500 opacity-75"></div>
</div>
<span aria-hidden="true" class="hidden sm:inline-block sm:align-middle md:h-screen">​</span>
<div aria-labelledby="modal-headline" aria-modal="true" class="inline-block align-bottom bg-white border-4 border-gray-50 rounded-xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle" role="dialog">
<div class="px-5 py-5">
<div class="">
<h3 class="text-2xl font-medium leading-8 md:leading-6 pb-2 text-gray-700" id="modal-headlinemd">
                 Keyboard Shortcuts:
                </h3>
<hr class=""/>
<div class="flex flex-row space-x-4 text-base text-gray-700" id="" role="group">
<div class="markdown">
<ul class="text-black text-base leading-loose">
<li class="list-none pb-1"><code>?</code><span class="ml-2">toggle shortcut descriptions</span></li>
<li class="list-none pb-1"><code>/</code><span class="ml-2"> search</span></li>
<li class="list-none pb-1"><code>j</code><span class="ml-2"> scroll down</span></li>
<li class="list-none pb-1"><code>k</code><span class="ml-2"> scroll up</span></li>
<li class="list-none pb-1 -ml-2"><code>tt</code><span class="ml-2"> toggle dark theme</span></li>
<li class="list-none pb-1 -ml-2"><code>gi</code><span class="ml-2"> go to blog index page</span></li>
<li class="list-none pb-1 -ml-2"><code>gn</code><span class="ml-2"> go to next article</span></li>
<li class="list-none pb-1 -ml-2"><code>gp</code><span class="ml-2"> go to previous article</span></li>
<li class="list-none pb-1 -ml-2"><code>gb</code><span class="ml-2"> go to previous page</span></li>
<li class="list-none pb-1 -ml-2"><code>gf</code><span class="ml-2"> go forwards</span></li>
<li class="list-none pb-1 -ml-2"><code>gc</code><span class="ml-2"> go to categories page</span></li>
<li class="list-none pb-1 -ml-2"><code>go</code><span class="ml-2"> go to article's category page</span></li>
<li class="list-none pb-1 -ml-2"><code>ga</code><span class="ml-2"> go to about page</span></li>
<li class="list-none pb-1 -ml-2"><code>ge</code><span class="ml-2"> go to experience page</span></li>
<li class="list-none pb-1 -ml-2"><code>gr</code><span class="ml-2"> go to portfolio page</span></li>
<li class="list-none pb-1 -ml-2"><code>gl</code><span class="ml-2"> go to landing page</span></li>
<li class="list-none pb-1 -ml-2"><code>vt</code><span class="ml-2"> only show technical articles on blog index page</span></li>
<li class="list-none pb-1 -ml-2"><code>vn</code><span class="ml-2"> only show non-technical articles on blog index page</span></li>
<li class="list-none pb-1 -ml-2"><code>va</code><span class="ml-2"> show articles from all categories on blog index page</span></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="hidden fixed z-10 inset-0 overflow-y-auto" id="fuseModal">
<div class="flex items-start justify-center text-center min-h-screen pb-80 px-4 md:block md:p-0">
<div aria-hidden="true" class="fixed inset-0 transition-opacity">
<div class="absolute inset-0 bg-gray-500 opacity-75" id="searchModalBackground"></div>
</div>
<div class="absolute inset-x-0 w-screen px-3">
<div aria-labelledby="modal-headline" aria-modal="true" class="w-full md:w-10/12 lg:w-8/12 mt-5 lg:mt-20 inline-block align-bottom bg-white border-4 border-gray-50 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle" role="dialog">
<div class="py-1 px-1">
<input class="mt-5 mb-3 px-3 mb-5 w-full text-gray-800 text-xl font-semibold border-2 border-gray-200 rounded-lg" id="searchBox" style="outline:0;" type="text"/>
<div class="hidden lg:inline-flex flex">
<div class="width-12 mx-1 px-2 text-gray-500 border border-gray-300 rounded-lg">
                    ctrl-k
                  </div>
                  or
                  <div class="width-12 mx-1 px-2 text-gray-500 border border-gray-300 rounded-lg">
                    /
                  </div>
</div>
<ul class="results text-lg text-bold text-gray-600" id="searchResults">
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="mx-auto w-full">
<div class="flex flex-row">
<div class="hidden xl:inline xl:w-32">
<div class="w-32">
<div class="mt-5 2xl:mt-20 fixed flex flex-col">
<div class="lg:w-32">
<div>
<a class="my-2 prose prose-xl leading-8 text-gray-700 dark:text-gray-200 hover:underline font-semibold block md:inline-block" href="https://johnmathews.eu/index.html"><i class="far fa-md fa-star"></i></a>
</div>
<div>
<a class="text-lg my-2 text-gray-700 dark:text-gray-200 hover:underline font-semibold block md:inline-block" href="https://johnmathews.eu/blog.html">Blog</a>
</div>
<div id="searchButton"> <a class="text-lg my-2 text-gray-700 dark:text-gray-200 hover:underline font-semibold block md:inline-block" href="javaScript:;">Search</a> </div>
<a class="text-lg my-2 text-gray-700 dark:text-gray-200 hover:underline font-semibold block md:inline-block" href="https://johnmathews.eu/portfolio.html">Portfolio</a>
<a class="text-lg my-2 text-gray-700 dark:text-gray-200 hover:underline font-semibold block md:inline-block" href="https://johnmathews.eu/about.html">About</a>
<a class="text-lg my-2 text-gray-700 dark:text-gray-200 hover:underline font-semibold block md:inline-block" href="https://johnmathews.eu/experience.html">Experience</a>
<div class="flex my-2">
<button aria-label="themeToggle" class="md:pl-0 my-2 theme-toggle" id="modeSwitcher2">
<div class="day modeIcon">
<i class="far fa-lightbulb fa-lg"></i>
</div>
<div class="night modeIcon hidden">
<i class="far fa-moon fa-lg"></i>
</div>
</button>
</div>
<div class="-mr-10 border-t-4 border-double border-gray-800 dark:border-gray-100 mt-20">
</div>
<div class="pt-20 font-serif text-lg text-gray-700 font-bold dark:text-gray-300">
    Published: <br/> August 2016
  </div>
<div class="pt-5 font-serif text-lg text-gray-700 font-bold dark:text-gray-300">
    Category:<br/>
<a href="https://johnmathews.eu/category/technical/cryptocurrencies.html">Cryptocurrencies</a>
</div>
</div>
</div>
</div>
</div>
<div class="w-full xl:w-5/6 xl:ml-20" id="contentParent">
<div class="mx-3 xl:ml-20 my-4 technical" id="articleParent">
<div class="mb-10">
<div class="markdown prose prose-md lg:prose-xl xl:prose-2xl leading-tight text-left mt-24 lg:-mr-30 xl:-mr-40 text-5xl md:text-6xl lg:text-8xl 2xl:text-9xl font-semibold lg:font-normal dark:text-gray-200" style="">
<span class="break-all" style="word-break: unset; white-space: wrap;">
          Encryption
        </span>
</div>
<div class="lg:hidden mt-20 text-lg font-serif font-bold text-gray-700 dark:text-gray-200">
        Category:
          <a href="https://johnmathews.eu/category/technical/cryptocurrencies.html">Cryptocurrencies</a>
</div>
<div class="lg:hidden text-lg font-serif font-light text-gray-600 dark:text-gray-200">
        August 2016
      </div>
</div>
<div class="mt-5 md:mt-20 md:mb-10 2xl:mt-40 2xl:mb-10 border-b-0 border-gray-600 dark:border-gray-200 border-double">
</div>
<main class="lg:w-4/6">
<article class="">
<div class="markdown">
<p>Blockchains use Elliptical Curve Cryptography (<span class="caps">ECC</span>) to authenticate users and authorise transactions. These notes introduce the field of cryptography and explains how modern cryptographic methods work. I wrote them to teach myself about encryption <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup></p>
<p>To begin with the absolute basics, encryption generally works by taking a message and representing it as a series of numbers <sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup> which are then turned into a series of random looking numbers. Decryption works by turning the random looking numbers back into the original message.</p>
<h2 id="background">Background</h2>
<p>The history of Cryptography can be split into classical and modern eras. Modern cryptography began in 1977 with the introduction of the <span class="caps">RSA</span> and Diffie-Hellman algorithms.  Until then, Cryptography required using a single key (the secret code) to encrypt and decrypt the message. This was transferred from sender to receiver secretly, but not cryptographically. In classical cryptography, the code is a <em>shared</em> secret.</p>
<p>The modern era removed the requirement for a shared secret and instead used number theory as a basis for quantifying the strength of an encryption method. The strength of a modern cryptographic technique is quantifiable and provable by reference to number theory, rather than a users ability to transport or transfer a secret code.</p>
<p>Modern cryptography is defined by Public Key Cryptographic systems. They use one key (code) for encryption and another for decryption. The encryption key can be made public without any risk of the message being decrypted, and is therefore known as the public key. The key used to decrypt data is the private key, and must not be revealed. If a message is encrypted with the public key it can only be decrypted with the private key.</p>
<p>Public Key Cryptographic (<span class="caps">PKC</span>) systems use algorithms that are easy to process in one direction but difficult to reverse, which are known as mathematical trap-door functions. A simple example of a trap-door function is the product of two prime numbers. If two random prime numbers are chosen, it is trivial to find their product. However if only the product of the two numbers is known, it is relatively difficult to find either of the factors used to create the number (this is factorisation). This was first noticed in 1874, when <a href="https://en.wikipedia.org/wiki/William_Stanley_Jevons#Jevons.27_number">Jevons</a> remarked:</p>
<blockquote>
<p><span class="dquo">“</span>Can the reader say what two numbers multiplied together will produce the number 8,616,460,799? I think it unlikely that anyone but myself will ever know.”*</p>
</blockquote>
<p>This simple problem shows that finding the product of two (secret) prime numbers is computationally simple, but factorising the result is not. This type of problem is a key feature of modern cryptography. Factoring prime numbers is a super famous mathematical problem, it was studied by <a href="https://en.wikipedia.org/wiki/Eratosthenes">Eratosthenes</a> <sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup> in the 3rd century <span class="caps">BC</span> and more recently the <a href="https://en.wikipedia.org/wiki/RSA_Factoring_Challenge"><span class="caps">RSA</span> Factoring Challenge</a> has intended to track state-of-the-art factorisation techniques by issues cash prizes for the factorisation of products of large primes.</p>
<p>Generally, the bigger the difference in difficulty between executing the function and reversing it, the better the cryptographic technique.</p>
<p>The <span class="caps">RSA</span> algorithm below uses factorisation as the foundation of its security, but factorisation is not the hardest problem to solve relative to the size of the keys required. Algorithms have been developed to factor the products of large prime numbers, and are much more efficient than randomly guessing possible factors. The greater the size of the primes being factored, the more efficient these algorithms become, and therefore the difference in difficulty between executing the function (multiplying two large primes) and reversing it (factorisation) becomes smaller as the size of the cryptographic key length increases. This is a problem because as public key cryptography becomes more commonly used the resources available to factor products of primes increases, and consequently larger keys are required.</p>
<p>Ultimately, encryption techniques based on the difficulty of factorisation will become redundant as the difficulty gap between creating and solving them shrinks. A better trap door function is required.</p>
<h2 id="overview-of-the-rsa-algorithm">Overview of the <span class="caps">RSA</span> algorithm</h2>
<p>Named after its founders (<a href="https://en.wikipedia.org/wiki/Ron_Rivest" title="Ron Rivest">Ron Rivest</a>, <a href="https://en.wikipedia.org/wiki/Adi_Shamir" title="Adi Shamir">Adi Shamir</a>, and <a href="https://en.wikipedia.org/wiki/Leonard_Adleman" title="Leonard">Leonard Adleman</a>), <span class="caps">RSA</span> was one of the first public-key encryption algorithms and is still widely used.</p>
<p><span class="caps">RSA</span> (as well as other cryptographic techniques) makes use of a number line which loops back to zero after reaching a maximum value, rather than increasing indefinitely. This means that once a maximum number <span class="math">\(n\)</span> has been defined, if a number greater than <span class="math">\(n\)</span> is created the result simply loops around to 0 and begins counting from 0 again. i.e. if <span class="math">\(n = 10\)</span>, then <span class="math">\(7 + 5 = 12 - 10 = 2\)</span>. The result of a calculation on a looping number line may easily be found by doing long division and using the remainder as the final answer, i.e. <span class="math">\(12 / 10 = 1\)</span> with <span class="math">\(2\)</span> remaining.</p>
<h2 id="generation-of-a-pair-of-rsa-keys">Generation of a pair of <span class="caps">RSA</span> keys:</h2>
<h3 id="1-generate-the-rsa-module">1. Generate the <span class="caps">RSA</span> module</h3>
<ul>
<li>Select two large random prime numbers, <span class="math">\(p\)</span> and <span class="math">\(q\)</span>. They need to be random because anyone who knows or guesses them will be able to decrypt the encryption.</li>
<li>Calculate <span class="math">\(n = pq\)</span></li>
</ul>
<h3 id="2-find-derived-number-e">2. Find derived number (e)</h3>
<ul>
<li><em>e</em> must be greater than 1 and less than <span class="math">\(( p - 1)( q - 1)\)</span>.</li>
<li>There must be no common factor for e and <span class="math">\(( p - 1)( q - 1)\)</span> except for 1. <sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup></li>
</ul>
<h3 id="3-form-the-public-key">3. Form the public key</h3>
<ul>
<li>The pair of numbers <span class="math">\((n, e)\)</span> form the public key and can be made public.</li>
<li>Even though <span class="math">\(n\)</span> is public, it is so difficult to factor the product of 2 large prime numbers that an attacker would not be able to find its component primes in the time available. The strength of <span class="caps">RSA</span> rests entirely on the difficulty of factoring <span class="math">\(n\)</span> into its two component prime numbers.</li>
</ul>
<h3 id="4-generate-the-private-key-d">4. Generate the private key (d)</h3>
<ul>
<li>The private key is generated from using <span class="math">\(p\)</span>, <span class="math">\(q\)</span> and e as inputs to the Extended Euclidean Algorithm. For a given set of values, there is a unique answer <span class="math">\(d\)</span>.</li>
<li><span class="math">\(d\)</span> is the inverse of <span class="math">\(e\)</span> modulo <span class="math">\(( p - 1)( q - 1 )\)</span>. This means that <span class="math">\(d\)</span> is the number less than <span class="math">\(( p - 1 ) ( q - 1 )\)</span> such that when it is multiplied by e, it is equal to <span class="math">\(1\)</span> modulo <span class="math">\(( p - 1 ) ( q - 1 )\)</span>.</li>
</ul>
<h2 id="rsa-example"><span class="caps">RSA</span> example:</h2>
<p><span class="caps">RSA</span> does not directly operate on strings as bits, it operates on numbers modulo (less than) <span class="math">\(n\)</span>. and it is necessary to represent plain text as a series of numbers less than <span class="math">\(n\)</span>. The dominant encoding on the internet is <a href="https://en.wikipedia.org/wiki/UTF-8"><span class="caps">UTF</span>-8</a>, which represents each upper case Latin letter as a number between 65 and 90. Using this encoding, a message “<span class="caps">HELLO</span>” would become “<span class="math">\(72, 69, 76, 76, 79\)</span>”.</p>
<p>The maximum number <span class="math">\(n\)</span> needs to be the product of the two prime numbers <span class="math">\(p\)</span> and <span class="math">\(q\)</span>. For this example choose <span class="math">\(p = 7\)</span> and <span class="math">\(q = 13\)</span>, so <span class="math">\(n  = 91\)</span> <sup id="fnref:5"><a class="footnote-ref" href="#fn:5">5</a></sup></p>
<p>The public key component <em>e</em> can be any number we choose,  as long as there is no number other than 1 which is a common factor of <em>e</em> and <span class="math">\(( p - 1 ) ( q - 1 )\)</span>. In our example, this requires that there be no common factor between 72 and e other than 1, so let <em>e</em> <span class="math">\(= 5\)</span>.</p>
<p>Therefore our public key is (91, 5). This can be made available to anyone without messages being decrypted because of the difficulty of factoring the product of (very large) prime numbers.</p>
<p>Using the fact that we know 5 and 11 are the prime factors of 55 and e is 5, we can use the Extended Euclidean Algorithm  to compute our private key <span class="math">\(d\)</span>, which is 29.</p>
<p>Therefore when the prime factors 7 and 13 are used, the public key is (91, 5) and the private key is (91, 29). These parameters fully define a functional <span class="caps">RSA</span> system.</p>
<h3 id="encoding">Encoding</h3>
<p>To encode a letter H in a message (‘H’ is <span class="math">\(72\)</span> in <span class="caps">UTF</span>-8), we need to multiply it by itself <span class="math">\(e\)</span> times (<span class="math">\(e = 5\)</span>), remembering to wrap around each time we pass our maximum value of <span class="math">\(n = 91\)</span>.</p>
<p><span class="math">\(72 \times 72 = 5184, 5184 / 91 = 56\)</span> with <span class="math">\(88\)</span> remaining, (i.e. <span class="math">\(5184 = 91 \times 56 + 88\)</span>). Therefore:
<span class="math">\(72 \times 72 = 5184 = 88\)</span>
<span class="math">\(88 \times 72 = 6336 = 57\)</span>
<span class="math">\(57 \times 72 = 4104 = 9\)</span>
<span class="math">\(9 \times 72 = 648 = 11\)</span></p>
<p>Therefore the encrypted value of “H” is “<span class="math">\(11\)</span><span class="dquo">“</span></p>
<p>Using the method for each character in the message “<span class="caps">HELLO</span>” results in the encoded message “\<span class="math">\(11,62,20,20,53\\)</span>”.</p>
<p>To decrypt the message, we take each number and multiply it by itself <span class="math">\(d\)</span> times, (<span class="math">\(d=29\)</span>) wrapping around each time we pass <span class="math">\(91\)</span>.</p>
<p><span class="math">\(11 \times 11 = 121 = 30\)</span>
<span class="math">\(30 \times 11 = 330 = 57\)</span>
…
<span class="math">\(57 \times 11 = 627 = 81\)</span>
<span class="math">\(81 \times 11 = 891 = 72\)</span></p>
<p>And we’re back to our original encoding.</p>
<h2 id="files">Files</h2>
<p>The spreadsheet I used to calculate the encrypted and decrypted values can be downloaded <a href="https://johnmathews.eu/RSA-Example.xlsx">here</a>.</p>
<p>A simple python script to encrypt and decrypt a message is <a href="https://johnmathews.eu/AES_Example.py">here</a>. It uses the <span class="caps">AES</span> encryption method.</p>
<h3 id="footnotes">Footnotes</h3>
<div class="footnote">
<hr/>
<ol>
<li id="fn:1">
<p>I used the explanations <a href="http://www.tutorialspoint.com/cryptography/public_key_encryption.htm">here</a> and <a href="https://blog.cloudflare.com/a-relatively-easy-to-understand-primer-on-elliptic-curve-cryptography/">here</a> a lot. <a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn:2">
<p>A simple example is <span class="math">\(A=1, B=2\)</span> etc <a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
<li id="fn:3">
<p>Eratosthenes invented his famous <a href="https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes">sieving algorithm</a> which finds all the primes up to a given limit. <a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">↩</a></p>
</li>
<li id="fn:4">
<p>If this is the case then e and ( p - 1) ( q - 1 ) are called “coprime” <a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">↩</a></p>
</li>
<li id="fn:5">
<p>Whilst the Extended Euclidean Algorithm is apparently simple to compute, its description is not. Therefore I’ve used the same numbers in the following example as in the tutorials <a href="http://www.tutorialspoint.com/cryptography/public_key_encryption.htm">here</a> and <a href="http://arstechnica.com/security/2013/10/a-relatively-easy-to-understand-primer-on-elliptic-curve-cryptography/">here</a>. <a class="footnote-backref" href="#fnref:5" title="Jump back to footnote 5 in the text">↩</a></p>
</li>
</ol>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
</div>
</article>
</main>
<div class="mt-20 mb-10 text-lg dark:text-gray-200">
<div class="flex flex-row">
<div class="text-red-500 dark:text-red-500"> ←  </div>
<a class="font-serif text-lg font-extrabold dark:text-gray-300 px-1 hover:text-red-500 dark:hover:text-red-500" href="https://johnmathews.eu/digital-currencies-the-basics.html" id="previousArticleInCategory"> Digital currencies: the basics</a>
</div>
<div class="flex flex-row mt-2">
<div class="text-green-500 dark:text-green-200"> → </div>
<a class="font-serif text-lg font-extrabold dark:text-gray-300 text-left px-1 hover:text-green-500 dark:hover:text-green-200" href="https://johnmathews.eu/aeternity-ico.html" id="nextArticleInCategory"> The Æternity <span class="caps">ICO</span>: My experience</a>
</div>
<div class="mt-2 font-serif text-lg text-gray-700 font-bold dark:text-gray-300">
<div class="">
<a class="text-blue-600 dark:text-blue-300 font-serif text-lg font-bold" href="https://johnmathews.eu/category/technical/cryptocurrencies.html" id="otherArticlesInCategory">Other articles in this category</a>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</main>
<footer class="footer w-5/6 mx-auto font-bold border-t-2 border-single border-gray-200 mt-10 py-3">
<div class="text-center font-serif text-lg text-gray-500 dark:text-gray-300">
<a class="px-3" href="https://johnmathews.eu/blog.html">Blog Posts</a> |
        <a class="px-3" href="#top">Back to top</a> |
        <a class="px-3" href="https://johnmathews.eu/categories.html">Categories</a> |
        <a class="px-3" href="https://johnmathews.eu/feeds/all.atom.xml">RSS</a>
</div>
</footer>
<script>
        const indexURL = 'https://johnmathews.eu/fuse.html';
        const siteURL = 'https://johnmathews.eu';
      </script>
<script crossorigin="anonymous" src="https://johnmathews.eu/theme/js/navbar.js" type="text/javascript"></script>
<script crossorigin="anonymous" src="https://johnmathews.eu/theme/js/fuseSearch.js" type="module"></script>
<script crossorigin="anonymous" src="https://johnmathews.eu/theme/js/keyboard-shortcuts.js" type="module"></script>
<script>
    const technical = $( "#articleParent" ).hasClass('technical');
    const nonTechnical = $( "#articleParent" ).hasClass('nonTechnical');

    // if user preference for article category has been set and is contradicted by currenct article, update it
    if (localStorage.getItem('categoryChoice') === "technical") {
      if (nonTechnical) {
        window.localStorage.setItem('categoryChoice', 'all');
      };
    } else if (localStorage.getItem('categoryChoice') === "nonTechnical") {
      if (technical) {
        window.localStorage.setItem('categoryChoice', 'all');
      };
    } else if (localStorage.getItem('categoryChoice') === "all") {
      // do nothing
    } else {
      // if user preference for article category hasn't been set, assign it using article type
      if (technical) {
        window.localStorage.setItem('categoryChoice', 'technical');
      } else if (nonTechnical) {
        window.localStorage.setItem('categoryChoice', 'nonTechnical');
      };
    }
  </script>
</body>
</html>